<rss xmlns:a10="http://www.w3.org/2005/Atom" version="2.0"><channel><title>nullfactory.net</title><link>http://nullfactory.net/rss.xml</link><description>nullfactory.net</description><item><guid isPermaLink="true">http://nullfactory.net/2015/02/obfuscate-sharepoint-ssrs-datasource/</guid><link>http://nullfactory.net/2015/02/obfuscate-sharepoint-ssrs-datasource/</link><title>Obfuscating a SharePoint-Integrated SSRS DataSource's Connection String</title><description>&lt;p&gt;When SQL Server Reporting Services (SSRS) is deployed as an SharePoint integrated solution, it enables much of its functionality to be managed right from within SharePoint. Starting from the 2013 version, the integration between SharePoint and SQL Server Reporting Services 2012 is more tightly coupled than previous iterations. &lt;/p&gt;

&lt;p&gt;One feature in integrated mode is the ability to have the data sources (.rsds) and report files (.rdl) within a document library itself. This means that reports can reference a DataSource within any document library in the SharePoint site. &lt;/p&gt;

&lt;p&gt;In order for the report to work the user should have read permission on both the data source as well as the report file. The problem with this is that the same user can now potentially view the settings within the data source file, including the connection string.&lt;/p&gt;

&lt;h2&gt;The Solution&lt;/h2&gt;

&lt;p&gt;In order to protect the connection string, I came up with a solution to obscure it through encryption. The solution can be broken down to two major steps:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Force the reports to get the connection string by evaluating an expression embedded within itself. &lt;/li&gt;
&lt;li&gt;Within this expression, call some custom code which manages the retrieval and decryption of the connection string. &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;One of the limitations with this method is that you can no longer use a shared data source and each report has to have its credentials embedded.&lt;/p&gt;

&lt;p&gt;In my example below, I will be retrieving the configuration string from a configuration list stored in the same SharePoint server. &lt;/p&gt;

</description><pubDate>Sun, 15 Feb 2015 18:30:00 Z</pubDate><a10:updated>2015-02-15T18:30:00Z</a10:updated><a10:content type="html">&lt;p&gt;When SQL Server Reporting Services (SSRS) is deployed as an SharePoint integrated solution, it enables much of its functionality to be managed right from within SharePoint. Starting from the 2013 version, the integration between SharePoint and SQL Server Reporting Services 2012 is more tightly coupled than previous iterations. &lt;/p&gt;

&lt;p&gt;One feature in integrated mode is the ability to have the data sources (.rsds) and report files (.rdl) within a document library itself. This means that reports can reference a DataSource within any document library in the SharePoint site. &lt;/p&gt;

&lt;p&gt;In order for the report to work the user should have read permission on both the data source as well as the report file. The problem with this is that the same user can now potentially view the settings within the data source file, including the connection string.&lt;/p&gt;

&lt;h2&gt;The Solution&lt;/h2&gt;

&lt;p&gt;In order to protect the connection string, I came up with a solution to obscure it through encryption. The solution can be broken down to two major steps:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Force the reports to get the connection string by evaluating an expression embedded within itself. &lt;/li&gt;
&lt;li&gt;Within this expression, call some custom code which manages the retrieval and decryption of the connection string. &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;One of the limitations with this method is that you can no longer use a shared data source and each report has to have its credentials embedded.&lt;/p&gt;

&lt;p&gt;In my example below, I will be retrieving the configuration string from a configuration list stored in the same SharePoint server. &lt;/p&gt;

&lt;!--excerpt--&gt;

&lt;h3&gt;Create the report extensions assembly&lt;/h3&gt;

&lt;p&gt;Here's a summary of steps used to create report extension. You can find a link to the full source at the bottom of the post.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Create new a class library to host your custom code.&lt;/li&gt;
&lt;li&gt;Next, sign the assembly as we would be deploying it into the Global Assembly Cache. &lt;/li&gt;
&lt;li&gt;&lt;p&gt;In order for the report server to call the custom code, the strong-named assembly must be marked with the &lt;code&gt;[assembly: AllowPartiallyTrustedCallers]&lt;/code&gt; attribute. Let's do this now.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ObfuscateSSRS/10_AllowPartiallyTrustedCallers.png" alt="Allow Partially Trusted Callers" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Create a new public class and method that would retrieve the connection string. This method would take the report server url as its only parameter. This parameter would be parsed and later used to generate the REST call to SharePoint. Next, add a &lt;code&gt;[SecuritySafeCritical]&lt;/code&gt; attribute to the method, we need to this to perform operations that require access outside of the sandbox. &lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ObfuscateSSRS/20_CodeGetConnectionString.png" alt="GetConnectionStringMethod" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Now, create a helper method that retrieves the default credentials. This too would be decorated with the &lt;code&gt;[SecuritySafeCritical]&lt;/code&gt; attribute. In the body of the method, I explicitly assert the &lt;code&gt;EnvironmentPermission(EnvironmentPermissionAccess.Read, "USERNAME")&lt;/code&gt; permissions before using the &lt;code&gt;CredentialStore&lt;/code&gt;. We would run into a security exception if the explicit assertion is not done. &lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ObfuscateSSRS/50_CodeGetSecurityCredentials.png" alt="GetSecurityCredential Method" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Finally, create the method that makes the REST call to retrieve the obfuscated connection string from a SharePoint configuration list.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ObfuscateSSRS/40_CodeGetWebPermission.png" alt="GetConnectionStringFromSharePointList Method" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The &lt;code&gt;EnvironmentPermission&lt;/code&gt; assertion operation has to be in its own method with its own &lt;code&gt;[SecuritySafeCritical]&lt;/code&gt; attribute for it to work together with the &lt;code&gt;WebPermission&lt;/code&gt; assertion. Otherwise the following exception would be thrown:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Exception: System.Security.SecurityException Exception Message: Stack walk modifier must be reverted before another modification of the same type can be performed. Stacktrace:    at System.Security.CodeAccessSecurityEngine.Assert(CodeAccessPermission cap, StackCrawlMark&amp;amp; stackMark)
   at System.Security.CodeAccessPermission.Assert()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;After numerous failed attempts at accessing the SPList via the SharePoint object model (I kept running into exceptions stating that I required full trust), I find that partial trust mode is &lt;a href="https://msdn.microsoft.com/en-us/library/office/dn268593.aspx"&gt;no longer supported and has been deprecated&lt;/a&gt;. As I was unable to find anyone online who had successfully got it to work, I opted to access the list via the REST service for its lesser dependencies and security permission requirements. &lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Compile and deploy the assembly into the Global Assembly Cache.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3&gt;Setting up the Report&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;Open up a copy of your report using the &lt;a href="http://www.microsoft.com/en-us/download/details.aspx?id=29072"&gt;latest version of Report Builder&lt;/a&gt;. &lt;/li&gt;
&lt;li&gt;&lt;p&gt;Right click on the work space area outside to bring up the context menu. Select the &lt;code&gt;Report Properties...&lt;/code&gt; menu item which opens up the &lt;code&gt;Report Properties&lt;/code&gt; dialog.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ObfuscateSSRS/60_ReportPropertiesContextMenu.png" alt="Build Process Parameter" /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ObfuscateSSRS/70_ReoprtPropertiesDialog.png" alt="Build Process Parameter" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Navigate to the &lt;code&gt;References&lt;/code&gt; tab and add an entry for our custom assembly.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Next, create a new entry for the class containing our custom logic. Ensure that the class name is referred to using it full namespace and provide an instance name that would be used to call our code from within the report.  &lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ObfuscateSSRS/80_ReportPropertiesDialog.png" alt="Build Process Parameter" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Now that our declarations have been done, edit the report data source for the report.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ObfuscateSSRS/90_EditDataSource.png" alt="Build Process Parameter" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Click on the &lt;code&gt;fx&lt;/code&gt; button to open up the expressions dialog.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ObfuscateSSRS/100_ConnStringSetExpression0.png" alt="Build Process Parameter" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Edit the expression to use the new custom method created previously. Pass in &lt;code&gt;Globals!ReportServerUrl&lt;/code&gt; as the method parameter.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ObfuscateSSRS/110_ConnStringSetExpression1.png" alt="Build Process Parameter" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Now, upload the updated report back into the SharePoint list hosting our report files. If you already have a report with the same name and with a shared data source linked to it, our connection details would be overwritten. In order to avoid this, delete the report in the list and re-upload our new one. &lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Next, edit the Report Data Source by selecting the &lt;code&gt;Manage Data Sources&lt;/code&gt; menu item in the context menu. Ensure that connection type is set to &lt;code&gt;Custom data source&lt;/code&gt; and connection string to &lt;code&gt;Use connection string expression defined in the report&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ObfuscateSSRS/130_ManageDataSource.png" alt="Build Process Parameter" /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ObfuscateSSRS/120_ConnStringNotInitialized.png" alt="Build Process Parameter" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;For the credentials, I will be using stored credentials. Note that the &lt;code&gt;Test Connection&lt;/code&gt; button does not work if the connection string needs to be evaluated at runtime.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2&gt;Final Thoughts&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;You can find the &lt;a href="https://github.com/shanec-/Nullfactory.SSRSExtensions"&gt;source here&lt;/a&gt;. It is meant only to be a template and should be extended to work with your own requirements.&lt;/li&gt;
&lt;li&gt;Since the custom assembly needs to be deployed into the Global Assembly Cache, I suggest including it as &lt;a href="https://msdn.microsoft.com/en-us/library/ee231595.aspx"&gt;part of the SharePoint Solution Package&lt;/a&gt; when automating your deployment process. &lt;/li&gt;
&lt;li&gt;Although this implementation was tested with a Microsoft SQL Server data source type, I suspect it can be altered to work with different connection types.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I would finally like to highlight the following articles as they gave me a lot of insight into Code Access Security (CAS) and better understanding of the security requirements I needed to address:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.simple-talk.com/dotnet/.net-framework/code-access-security-in-asp.net-4.0/"&gt;Simple-Talk - Code Access Security in ASP.NET 4.0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.simple-talk.com/dotnet/.net-framework/whats-new-in-code-access-security-in-.net-framework-4.0---part-i/"&gt;Simple-Talk - What's New in Code Access Security in .NET Framework 4.0 - Part I&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.simple-talk.com/dotnet/.net-framework/whats-new-in-code-access-security-in-.net-framework-4.0---part-2/"&gt;Simple-Talk - What's New in Code Access Security in .NET Framework 4.0 - Part 2&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;References&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://technet.microsoft.com/en-us/library/bb326290%28v=sql.105%29.aspx"&gt;Technet - Features Supported by Reporting Services in SharePoint Integrated Mode&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://social.msdn.microsoft.com/Forums/sqlserver/en-US/d4588e88-5cb9-47cf-817b-a69942c507ac/how-to-use-microsoftsharepointdll-api-in-custom-assembly-of-ssrs-report?forum=sqlreportingservices"&gt;MSDN Forums - How to use "Microsoft.SharePoint.dll" API in custom assembly of SSRS report&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://msdn.microsoft.com/en-us/library/ms154658.aspx"&gt;MSDN - Code Access Security in Reporting Services&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://msdn.microsoft.com/en-us/library/ms153561.aspx"&gt;MSDN - Using Custom Assemblies with Reports&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://msdn.microsoft.com/en-us/library/ms154645.aspx"&gt;MSDN - Referencing Assemblies in an RDL File&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://msdn.microsoft.com/en-us/library/ms155034.aspx"&gt;MSDN - Deploying a Custom Assembly&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://msdn.microsoft.com/en-us/library/ms153587.aspx"&gt;MSDN - Asserting Permissions in Custom Assemblies&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://msdn.microsoft.com/en-us/library/ms154507.aspx"&gt;MSDN - Accessing Custom Assemblies Through Expressions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://msdn.microsoft.com/en-us/library/ms153693.aspx"&gt;MSDN - How to: Debug Custom Assemblies&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.simple-talk.com/dotnet/.net-framework/code-access-security-in-asp.net-4.0/"&gt;Simple-Talk - Code Access Security in ASP.NET 4.0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.simple-talk.com/dotnet/.net-framework/whats-new-in-code-access-security-in-.net-framework-4.0---part-i/"&gt;Simple-Talk - What's New in Code Access Security in .NET Framework 4.0 - Part I&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.simple-talk.com/dotnet/.net-framework/whats-new-in-code-access-security-in-.net-framework-4.0---part-2/"&gt;Simple-Talk - What's New in Code Access Security in .NET Framework 4.0 - Part 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://msdn.microsoft.com/en-us/library/office/dn268593.aspx"&gt;MSDN - Deciding between apps for SharePoint and SharePoint solution - Partial-trust user code is deprecated&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://msdn.microsoft.com/en-us/library/ee231595.aspx"&gt;MSDN - How to: Add and Remove Additional Assemblies&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</a10:content></item><item><guid isPermaLink="true">http://nullfactory.net/2015/02/tfs-customizie-build-template-to-exclude-symbols/</guid><link>http://nullfactory.net/2015/02/tfs-customizie-build-template-to-exclude-symbols/</link><title>Customize a Build Template to Exclude Symbols From Being Published to the Symbol Server</title><description>&lt;p&gt;This post was inspired by a feedback provided by one of the commenters on &lt;a href="http://www.edsquared.com/2011/02/12/Source+Server+And+Symbol+Server+Support+In+TFS+2010.aspx"&gt;this post&lt;/a&gt;. The requirement was to exclude certain third party symbols from being published to the symbol server. I thought I would take upon the challenge to implement this.&lt;/p&gt;

&lt;p&gt;As suggested in the same comment thread, my approach would revolve around explicitly setting the &lt;code&gt;FileList&lt;/code&gt; property in the &lt;code&gt;PublishSymbols&lt;/code&gt; activity. I would set it to a list that includes only the symbols that I want published. And the symbols I want to be excluded would be handled through a wild card filter that is passed as a build template parameter.&lt;/p&gt;

&lt;h2&gt;Pre-Requisites&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;A properly configured symbol server. Check out my previous on &lt;a href="http://nullfactory.net/2015/01/setting-up-tfs-source-symbol-servers/"&gt;automatically publishing debug symbols&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;Customization Steps&lt;/h2&gt;

&lt;p&gt;My template is based on the default TFS template &lt;code&gt;TfvcTemplate.12.xaml&lt;/code&gt; and customized with the following changes:&lt;/p&gt;

</description><pubDate>Sun, 08 Feb 2015 18:30:00 Z</pubDate><a10:updated>2015-02-08T18:30:00Z</a10:updated><a10:content type="html">&lt;p&gt;This post was inspired by a feedback provided by one of the commenters on &lt;a href="http://www.edsquared.com/2011/02/12/Source+Server+And+Symbol+Server+Support+In+TFS+2010.aspx"&gt;this post&lt;/a&gt;. The requirement was to exclude certain third party symbols from being published to the symbol server. I thought I would take upon the challenge to implement this.&lt;/p&gt;

&lt;p&gt;As suggested in the same comment thread, my approach would revolve around explicitly setting the &lt;code&gt;FileList&lt;/code&gt; property in the &lt;code&gt;PublishSymbols&lt;/code&gt; activity. I would set it to a list that includes only the symbols that I want published. And the symbols I want to be excluded would be handled through a wild card filter that is passed as a build template parameter.&lt;/p&gt;

&lt;h2&gt;Pre-Requisites&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;A properly configured symbol server. Check out my previous on &lt;a href="http://nullfactory.net/2015/01/setting-up-tfs-source-symbol-servers/"&gt;automatically publishing debug symbols&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;Customization Steps&lt;/h2&gt;

&lt;p&gt;My template is based on the default TFS template &lt;code&gt;TfvcTemplate.12.xaml&lt;/code&gt; and customized with the following changes:&lt;/p&gt;

&lt;!--excerpt--&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Start off by adding the build template parameter that accepts filter:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;ExclusionFilter&lt;/code&gt; - &lt;em&gt;Text that would be used as part of the wild card filter.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ExcludeSymbols/10_Parameters.png" alt="Build Process Parameter" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Next, the variables that would be needed:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;CustomAllSymbolsList&lt;/code&gt; - &lt;em&gt;Temporarily store the symbol files that are found&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CustomExcludedSymbolsList&lt;/code&gt; - &lt;em&gt;Temporarily store the symbols that need to be excluded.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CustomFilteredSymbolsList&lt;/code&gt; - &lt;em&gt;The final list of symbols that would be published to the symbol server.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;CustomBinDirectory&lt;/code&gt; - &lt;em&gt;Temporary store the Binaries Directory path.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ExcludeSymbols/20_Variables.png" alt="Build Process Variables" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Now get the &lt;code&gt;WellKnowEnvironmentalVariables.BinariesDirectory&lt;/code&gt; value using the &lt;code&gt;GetEnvironmentalVariable&amp;lt;T&amp;gt;&lt;/code&gt; activity.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ExcludeSymbols/40_EnvronmentalVariableActivity.png" alt="GetEnvironmentalVariable&lt;T&gt;" /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ExcludeSymbols/30_EnvironmentalVariable.png" alt="Built-In Environmental Variable" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Get a list of all the available symbols from the build folder.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;This is done using a &lt;code&gt;FindMatchingFiles&lt;/code&gt; activity with a &lt;code&gt;String.Format("{0}\**\*.pdb", CustomBinDirectory)&lt;/code&gt; pattern.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ExcludeSymbols/45_FindAllSymbols.png" alt="Find All Symbols" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Get a list of of symbols that need to be excluded from the Symbol Server.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Again, a &lt;code&gt;FindMatchingFiles&lt;/code&gt; activity with &lt;code&gt;String.Format("{0}\**\*{1}*.pdb", CustomBinDirectory, ExclusionFilter)&lt;/code&gt; pattern.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ExcludeSymbols/47_FindSymbolsToExclude.png" alt="Find Symbols to be excluded" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Since the &lt;code&gt;FindMatchingFiles&lt;/code&gt; activity returns an &lt;code&gt;IEnumberable&amp;lt;string&amp;gt;&lt;/code&gt; we create a new list that we can actually manipulate.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ExcludeSymbols/50_InitializeSymbolList.png" alt="Find Symbols to be excluded" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Add all the symbols to the new list.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ExcludeSymbols/60_AddToCollection.png" alt="Add symbols" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Remove the symbols that need to be excluded. &lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ExcludeSymbols/70_RemoveFromCollection.png" alt="Remove symbols" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Pass the filtered collection into the &lt;code&gt;PublishSymbols&lt;/code&gt; activity via the &lt;code&gt;FileList&lt;/code&gt; property.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ExcludeSymbols/80_PublishSymbols.png" alt="PublishSymbols Activity" /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ExcludeSymbols/90_FilteredPublishSymbols.png" alt="PublishSymbols, FileList" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2&gt;Using the Build Definition&lt;/h2&gt;

&lt;p&gt;Create a new build definition using the new template and provide valid values for &lt;code&gt;Path to publish symbols&lt;/code&gt;and &lt;code&gt;ExclusionFilter&lt;/code&gt; parameters. &lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/ExcludeSymbols/100_EditBuildDefinition.png" alt="Edit build definition" /&gt;&lt;/p&gt;

&lt;p&gt;Finally, queue a new build and verify that the symbols are excluded the symbols store. &lt;/p&gt;

&lt;p&gt;The final customized template can be &lt;a href="https://github.com/shanec-/Nullfactory.TfsBuildExtensions/blob/master/src/Template/ExcludedSymbolsTfvcTemplate.12.xaml"&gt;downloaded here&lt;/a&gt;.&lt;/p&gt;

&lt;h2&gt;References&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://msdn.microsoft.com/en-us/library/hh190722.aspx"&gt;MSDN - Index and publish symbol data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://msdn.microsoft.com/en-us/library/gg265783.aspx#Activity_IndexSources"&gt;MSDN - Embed version control paths and versions into the symbol data in Your PDB files (IndexSources activity)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://msdn.microsoft.com/en-us/library/gg265783.aspx#Activity_PublishSymbols"&gt;MSDN - Publish symbols to a SymStore symbol store (PublishSymbols activity)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.ewaldhofman.nl/post/2010/04/27/Customize-Team-Build-2010-e28093-Part-2-Add-arguments-and-variables.aspx"&gt;Ewald Hofman | Customize Team Build 2010 – Part 2: Add arguments and variables&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://msdn.microsoft.com/en-us/library/dd647551.aspx"&gt;MSDN- Customize your build process template&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://msdn.microsoft.com/en-gb/library/hh850448.aspx"&gt;MSDN - Team Foundation Build environment variables&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://msdn.microsoft.com/en-us/library/dn231755.aspx"&gt;MSDN - GetEnvironmentVariable&lt;T&gt; Class&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.build.activities.extensions.wellknownenvironmentvariables.binariesdirectory.aspx"&gt;MSDN - WellKnownEnvironmentVariables.BinariesDirectory Field&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</a10:content></item><item><guid isPermaLink="true">http://nullfactory.net/2015/01/tfstip-disable-windows-update-prior-upgrade/</guid><link>http://nullfactory.net/2015/01/tfstip-disable-windows-update-prior-upgrade/</link><title>TFS Tip: Disable Windows Update Prior TFS Upgrade</title><description>&lt;p&gt;Always make sure to disable the windows update services before starting any significant software upgrade. We found out the hard way that process such as a long running database backup does not handle kindly to spontaneous server restarts.&lt;/p&gt;

&lt;p&gt;Its one of those thing that can easily slip through the cracks but have a large impact in your deployment. So always make sure to add this to part of your per-requisite checklist.&lt;/p&gt;

&lt;p&gt;Personally I use the &lt;code&gt;net stop "windows update"&lt;/code&gt; command as it is only effective until you restart the computer/service.&lt;/p&gt;

</description><pubDate>Sat, 10 Jan 2015 18:30:00 Z</pubDate><a10:updated>2015-01-10T18:30:00Z</a10:updated><a10:content type="html">&lt;p&gt;Always make sure to disable the windows update services before starting any significant software upgrade. We found out the hard way that process such as a long running database backup does not handle kindly to spontaneous server restarts.&lt;/p&gt;

&lt;p&gt;Its one of those thing that can easily slip through the cracks but have a large impact in your deployment. So always make sure to add this to part of your per-requisite checklist.&lt;/p&gt;

&lt;p&gt;Personally I use the &lt;code&gt;net stop "windows update"&lt;/code&gt; command as it is only effective until you restart the computer/service.&lt;/p&gt;

&lt;!--excerpt--&gt; 

&lt;p&gt;Here are some ways to achieve the same: &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://superuser.com/questions/603315/how-do-i-stop-the-windows-8-restart-clock-15-minutes-and-counting"&gt;http://superuser.com/questions/603315/how-do-i-stop-the-windows-8-restart-clock-15-minutes-and-counting&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.wikihow.com/Disable-Automatic-Reboot-After-Windows-Update"&gt;http://www.wikihow.com/Disable-Automatic-Reboot-After-Windows-Update&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;References&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://superuser.com/questions/603315/how-do-i-stop-the-windows-8-restart-clock-15-minutes-and-counting"&gt;Super User - shutdown - How do I stop the Windows 8 restart clock; '15 minutes' and counting...?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.wikihow.com/Disable-Automatic-Reboot-After-Windows-Update"&gt;WikiHow - 3 Ways to Disable Automatic Reboot After Windows Update&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</a10:content></item><item><guid isPermaLink="true">http://nullfactory.net/2015/01/tfs-scheduled-backups-not-working-quiesced/</guid><link>http://nullfactory.net/2015/01/tfs-scheduled-backups-not-working-quiesced/</link><title>TFS Tip: Scheduled Backups Do Not Work While the Service Is Quiesced</title><description>&lt;p&gt;Last month I worked on upgrading a Team Foundation Server from 2012.2 to 2013.4. While majority of the process was based on the off of the &lt;a href="http://vsarupgradeguide.codeplex.com/"&gt;ALM Rangers upgrade guide&lt;/a&gt;, there were a few interesting tidbits that we learned during the upgrade.  &lt;/p&gt;

&lt;p&gt;The most important one was that Scheduled Backups feature no longer works if the services are stopped using the &lt;code&gt;TFSServiceControl quiesce&lt;/code&gt; command.&lt;/p&gt;

&lt;p&gt;While the &lt;a href="http://msdn.microsoft.com/en-us/library/ff470382.aspx"&gt;MSDN Article&lt;/a&gt; for the command does state that it would take down all the services, it also says that you would normally use this command in order to facilitate backups. 
As such we assumed, incorrectly, that it would not apply to the scheduled backup service. &lt;/p&gt;

</description><pubDate>Fri, 09 Jan 2015 18:30:00 Z</pubDate><a10:updated>2015-01-09T18:30:00Z</a10:updated><a10:content type="html">&lt;p&gt;Last month I worked on upgrading a Team Foundation Server from 2012.2 to 2013.4. While majority of the process was based on the off of the &lt;a href="http://vsarupgradeguide.codeplex.com/"&gt;ALM Rangers upgrade guide&lt;/a&gt;, there were a few interesting tidbits that we learned during the upgrade.  &lt;/p&gt;

&lt;p&gt;The most important one was that Scheduled Backups feature no longer works if the services are stopped using the &lt;code&gt;TFSServiceControl quiesce&lt;/code&gt; command.&lt;/p&gt;

&lt;p&gt;While the &lt;a href="http://msdn.microsoft.com/en-us/library/ff470382.aspx"&gt;MSDN Article&lt;/a&gt; for the command does state that it would take down all the services, it also says that you would normally use this command in order to facilitate backups. 
As such we assumed, incorrectly, that it would not apply to the scheduled backup service. &lt;/p&gt;

&lt;!--excerpt--&gt; 

&lt;blockquote&gt;
  &lt;p&gt;The lesson learned here is that we should &lt;code&gt;quiesce&lt;/code&gt; the service only for manual backups of the databases. &lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;One we figured this out, we manually took the backups and everything was alright in the world again. &lt;/p&gt;

&lt;h2&gt;References&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://msdn.microsoft.com/en-us/library/ms253151.aspx"&gt;MSDN - Understanding backing up Team Foundation Server&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://blogs.msdn.com/b/granth/archive/2013/02/13/tfs2012-what-are-all-the-different-jobs-built-in-to-tfs.aspx"&gt;Grant Holliday’s blog - TFS2012: What are all the different Jobs built-in to TFS?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://vsarupgradeguide.codeplex.com/"&gt;CodePlex - TFS Upgrade Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://chamindac.blogspot.com/2014/12/tfs-backuprestore-lessons-learnt.html"&gt;Chaminda's Blog - TFS Backup/Restore – Lessons Learnt&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</a10:content></item><item><guid isPermaLink="true">http://nullfactory.net/2015/01/setting-up-tfs-source-symbol-servers/</guid><link>http://nullfactory.net/2015/01/setting-up-tfs-source-symbol-servers/</link><title>Setting up Source and Symbol Servers in Team Foundation Server</title><description>&lt;h2&gt;What are debug symbols?&lt;/h2&gt;

&lt;p&gt;Debug symbols are artifacts that a debugger can use in order to better debug an application. Within the.NET ecosystem these are managed through PDB files. The PDB files contain information about the source file name, line numbers as well as local variable names.&lt;/p&gt;

&lt;p&gt;As a software solution evolves, it is likely that multiple versions of it gets deployed into different production systems. And once the software is out in the wild, it becomes important that the developers can react to issues discovered by debugging specific versions. In order to do this effectively, it is important that the debug symbols themselves be treated as an first class artifact of the build and that it is readily accessible. Team Foundation Server (TFS) achieves this via a Source Server and Symbol Server.&lt;/p&gt;

&lt;h2&gt;The Source Server and Symbol Server&lt;/h2&gt;

&lt;p&gt;A Source Server component is essentially letting TFS know that we would be retrieving specific versions of source files and that it should be indexed. And a Symbol Server is a fancy name for a networked file share location containing the multiple versions of symbols &lt;a href="http://blogs.msdn.com/b/jimlamb/archive/2009/06/15/symbol-and-source-server-in-tfs-2010.aspx"&gt;[read more]&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;A TFS build definition will be configured in order to automatically index sources and publish symbols &lt;a href="http://blogs.msdn.com/b/adamroot/archive/2009/06/17/source-server-and-symbol-server-features-in-team-foundation-server-2010-beta-1.aspx"&gt;[read more]&lt;/a&gt;.&lt;/p&gt;

</description><pubDate>Wed, 31 Dec 2014 18:30:00 Z</pubDate><a10:updated>2014-12-31T18:30:00Z</a10:updated><a10:content type="html">&lt;h2&gt;What are debug symbols?&lt;/h2&gt;

&lt;p&gt;Debug symbols are artifacts that a debugger can use in order to better debug an application. Within the.NET ecosystem these are managed through PDB files. The PDB files contain information about the source file name, line numbers as well as local variable names.&lt;/p&gt;

&lt;p&gt;As a software solution evolves, it is likely that multiple versions of it gets deployed into different production systems. And once the software is out in the wild, it becomes important that the developers can react to issues discovered by debugging specific versions. In order to do this effectively, it is important that the debug symbols themselves be treated as an first class artifact of the build and that it is readily accessible. Team Foundation Server (TFS) achieves this via a Source Server and Symbol Server.&lt;/p&gt;

&lt;h2&gt;The Source Server and Symbol Server&lt;/h2&gt;

&lt;p&gt;A Source Server component is essentially letting TFS know that we would be retrieving specific versions of source files and that it should be indexed. And a Symbol Server is a fancy name for a networked file share location containing the multiple versions of symbols &lt;a href="http://blogs.msdn.com/b/jimlamb/archive/2009/06/15/symbol-and-source-server-in-tfs-2010.aspx"&gt;[read more]&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;A TFS build definition will be configured in order to automatically index sources and publish symbols &lt;a href="http://blogs.msdn.com/b/adamroot/archive/2009/06/17/source-server-and-symbol-server-features-in-team-foundation-server-2010-beta-1.aspx"&gt;[read more]&lt;/a&gt;.&lt;/p&gt;

&lt;!--excerpt--&gt;

&lt;h2&gt;Configuration&lt;/h2&gt;

&lt;p&gt;There are two components that need to be configured for an effective workflow. The build definition; this would be instructing TFS to index the sources and publish the symbols to a share location. Then instruct each of the clients (Visual Studio in this case) to use the symbol cache.&lt;/p&gt;

&lt;h3&gt;Build Definition (Server)&lt;/h3&gt;

&lt;p&gt;Configuring the build definition is pretty straight forward:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Setup a file share on a server other than the build agent. This server should be able to be accessed from the build agent as well as any clients that would be debugging the code.&lt;/li&gt;
&lt;li&gt;Grant build service account write access permission to the folder.  &lt;/li&gt;
&lt;li&gt;Grant all project contributors read access to this folder.&lt;/li&gt;
&lt;li&gt;Edit the build definition by providing a value to the &lt;code&gt;Publish Symbols &amp;gt; Path to publish symbols&lt;/code&gt; property. Set it to the previously created network folder.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/SetupSymbolServer/1_PathToPublishSymbols.png" alt="Setup the Build Definition" /&gt;&lt;/p&gt;

&lt;h3&gt;Clients&lt;/h3&gt;

&lt;p&gt;Now that the server is setup, we configure visual studio to take advantage of the symbol store:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Open up Visual Studio and navigate to &lt;code&gt;Tools &amp;gt; Options &amp;gt; Debugging&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Under the &lt;code&gt;General&lt;/code&gt; section, check the &lt;code&gt;Enable source server support&lt;/code&gt; flag.
&lt;img src="http://nullfactory.net/images/posts/SetupSymbolServer/2_VsEnableSourceServerSupport.png" alt="Enable Source Server Support" /&gt;&lt;/li&gt;
&lt;li&gt;Next, navigate to &lt;code&gt;Symbols&lt;/code&gt; node.&lt;/li&gt;
&lt;li&gt;Create a new symbol file location entry and set the cache directory to the previously created share location.
&lt;img src="http://nullfactory.net/images/posts/SetupSymbolServer/3_VsSetupSymbolCache.png" alt="Setup the Symbol Cache" /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;The debug symbols would automatically be published to the share location every time a new build is triggered. The Visual Studio clients should be able to use the appropriate symbols when debugging.&lt;/p&gt;

&lt;h2&gt;References&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.edsquared.com/2011/02/12/Source+Server+And+Symbol+Server+Support+In+TFS+2010.aspx"&gt;Source Server and Symbol Server Support in TFS 2010 - Ed Squared&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://blogs.msdn.com/b/adamroot/archive/2009/06/17/source-server-and-symbol-server-features-in-team-foundation-server-2010-beta-1.aspx"&gt;MSDN Blogs - Source Server and Symbol Server Features in Team Foundation Server 2010 - Anything's Possible&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://blogs.msdn.com/b/jimlamb/archive/2009/06/15/symbol-and-source-server-in-tfs-2010.aspx"&gt;MSDN Blogs - Enabling Symbol and Source Server Support in TFS Build 2010&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://blogs.msdn.com/b/buckh/archive/2011/04/11/making-debugging-easier-source-indexing-and-symbol-server.aspx"&gt;MSDN Blogs - Making debugging easier: Source Indexing and Symbol Server&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</a10:content></item><item><guid isPermaLink="true">http://nullfactory.net/2014/12/tfs-enable-reporting-warehouse-analysis-services/</guid><link>http://nullfactory.net/2014/12/tfs-enable-reporting-warehouse-analysis-services/</link><title>TFS 2013 - Enabling Reporting, Warehouse and Analysis Services</title><description>&lt;p&gt;Suppose you already have an Team Foundation Server (TFS) environment where you have opted-out from configuring the Reporting Services and Analysis Services during the installation. The following steps would help you to configure the warehouse and reporting functionality.&lt;/p&gt;

&lt;h2&gt;Pre-Requisites&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Ensure that the SQL Server client tools are installed on the Application Tier.&lt;/p&gt;

&lt;p&gt;If this is not already done, you would most likely receive a &lt;code&gt;TF400465&lt;/code&gt; error when attempting to edit the configuration. &lt;code&gt;TF400465&lt;/code&gt; states that client tool are needed to be installed on the application tier in order for the analysis services to function properly.&lt;/p&gt;

&lt;p&gt;This can be fixed by re-running the SQL Server setup and adding the &lt;code&gt;Client Tools Connectivity&lt;/code&gt; feature &lt;a href="http://msdn.microsoft.com/en-us/library/dd578652.aspx"&gt;[Read More]&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Once installed, make sure to restart the TFS administration console.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ensure that &lt;code&gt;Management Tools - Complete&lt;/code&gt; is installed on at least one of the servers in your topology. This is because SQL Server Management Studio requires the complete version installed in order to manage Analysis Services. This step optional but makes it easy for troubleshooting or future maintenance.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Ensure that the Analysis Services have been installed and is up and running.&lt;/li&gt;
&lt;li&gt;Ensure SQL Server Reporting Services is installed and configured in native mode &lt;a href="http://msdn.microsoft.com/en-us/library/aa545752%28v=cs.70%29.aspx"&gt;[Read More]&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;This goes without saying, Analysis Services and Reporting Services are not available on the express version of SQL Server.&lt;/li&gt;
&lt;/ol&gt;

</description><pubDate>Fri, 26 Dec 2014 18:30:00 Z</pubDate><a10:updated>2014-12-26T18:30:00Z</a10:updated><a10:content type="html">&lt;p&gt;Suppose you already have an Team Foundation Server (TFS) environment where you have opted-out from configuring the Reporting Services and Analysis Services during the installation. The following steps would help you to configure the warehouse and reporting functionality.&lt;/p&gt;

&lt;h2&gt;Pre-Requisites&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Ensure that the SQL Server client tools are installed on the Application Tier.&lt;/p&gt;

&lt;p&gt;If this is not already done, you would most likely receive a &lt;code&gt;TF400465&lt;/code&gt; error when attempting to edit the configuration. &lt;code&gt;TF400465&lt;/code&gt; states that client tool are needed to be installed on the application tier in order for the analysis services to function properly.&lt;/p&gt;

&lt;p&gt;This can be fixed by re-running the SQL Server setup and adding the &lt;code&gt;Client Tools Connectivity&lt;/code&gt; feature &lt;a href="http://msdn.microsoft.com/en-us/library/dd578652.aspx"&gt;[Read More]&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Once installed, make sure to restart the TFS administration console.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ensure that &lt;code&gt;Management Tools - Complete&lt;/code&gt; is installed on at least one of the servers in your topology. This is because SQL Server Management Studio requires the complete version installed in order to manage Analysis Services. This step optional but makes it easy for troubleshooting or future maintenance.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Ensure that the Analysis Services have been installed and is up and running.&lt;/li&gt;
&lt;li&gt;Ensure SQL Server Reporting Services is installed and configured in native mode &lt;a href="http://msdn.microsoft.com/en-us/library/aa545752%28v=cs.70%29.aspx"&gt;[Read More]&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;This goes without saying, Analysis Services and Reporting Services are not available on the express version of SQL Server.&lt;/li&gt;
&lt;/ol&gt;

&lt;!--excerpt--&gt;

&lt;h2&gt;Configuration&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Navigate to TFS Administration Console &lt;code&gt;Application Tier &amp;gt; Reporting&lt;/code&gt;. Notice that the services are not configured.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/TFSEnableReportingAnalysisServices/1_ConsoleUnconfigured.png" alt="" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Click &lt;code&gt;Edit&lt;/code&gt; to edit the configuration.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Check the &lt;code&gt;Use Reporting&lt;/code&gt; check box to get started.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Configure the warehouse house by first selecting the SQL server from the server list.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/TFSEnableReportingAnalysisServices/2_WarehouseDetails.png" alt="" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Next, provide a name for the warehouse database; I gave it &lt;code&gt;Tfs_Warehouse&lt;/code&gt; as it is what the latest versions of TFS provides by default.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Click &lt;code&gt;Test Connection&lt;/code&gt; to ensure the connectivity to the server.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Switch over to the &lt;code&gt;Analysis Services&lt;/code&gt; tab and select the server for the analysis services from the server list.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/TFSEnableReportingAnalysisServices/3_AnalysisDetails.png" alt="" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Provide the database name &lt;code&gt;Tfs_Analysis&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Provide the username and password for accessing the data sources.&lt;/li&gt;
&lt;li&gt;Click &lt;code&gt;Test Connection&lt;/code&gt; to ensure the connectivity to the server.&lt;/li&gt;
&lt;li&gt;Next select the &lt;code&gt;Reports&lt;/code&gt; tab.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Select the report server from the server list.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/TFSEnableReportingAnalysisServices/4_ReportingDetails.png" alt="" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Click the &lt;code&gt;Populate URLs&lt;/code&gt;. This would retrieve the Web Service and Report Manager urls. In case they are not populated automatically, provide the details manually.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Provide the username and password for accessing the data sources.&lt;/li&gt;
&lt;li&gt;Click &lt;code&gt;OK&lt;/code&gt; to save the settings.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Click the &lt;code&gt;Start Jobs&lt;/code&gt; to activate the services.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/TFSEnableReportingAnalysisServices/5_ConsoleConfigured.png" alt="" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The final step is to rebuild the warehouse. This would prepare the database by building the necessary schema and any pre-requisite operations. This can be achieved in one of the following ways:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Executing the &lt;code&gt;RebuildWarehouse&lt;/code&gt; command &lt;a href="http://msdn.microsoft.com/en-us/library/ee349264.aspx"&gt;[Read More]&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Navigate to the &lt;code&gt;WarehouseControlService&lt;/code&gt; webservice and execute &lt;code&gt;ProcessAnalysisDatabase&lt;/code&gt; with &lt;code&gt;processingType&lt;/code&gt; of &lt;code&gt;Full&lt;/code&gt; &lt;a href="http://msdn.microsoft.com/en-us/library/ff400237.aspx"&gt;[Read More]&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Open up the TFS Administration Console and navigate to &lt;code&gt;Application Tier &amp;gt; Reporting &amp;gt; Start Rebuild&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/TFSEnableReportingAnalysisServices/6_RebuildConfirmation.png" alt="" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2&gt;Verification&lt;/h2&gt;

&lt;p&gt;Once the &lt;code&gt;RebuildWarehouse&lt;/code&gt; command has been executed, verify that the warehouse jobs are running. This can be done by logging onto the application tier and then navigating to the &lt;code&gt;WarehouseControlWebService&lt;/code&gt; using the following url and executing the &lt;code&gt;GetProcessingStatus&lt;/code&gt; action:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    http://localhost:8080/tfs/TeamFoundation/Administration/v3.0/WarehouseControlService.asmx
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This would return a list of all the jobs that are being executed on the server. The first time I viewed the results, I was a bit overwhelmed by the number of errors shown. If you take a moment and study the errors you realize that these are warnings about SQL locks. Given enough time, and depending on the size of the Project Collections, the errors (warnings) should resolve themselves. As far as I can tell these warnings are expected in a full rebuild.&lt;/p&gt;

&lt;h2&gt;References&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://msdn.microsoft.com/en-us/library/aa545752%28v=cs.70%29.aspx"&gt;MSDN - How to Configure Reporting Services&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://msdn.microsoft.com/en-us/library/dd578652.aspx"&gt;MSDN - Manually install SQL Server for Team Foundation Server&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://msdn.microsoft.com/en-us/library/ee349264.aspx"&gt;MSDN - RebuildWarehouse Command&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://msdn.microsoft.com/en-us/library/ff400237.aspx"&gt;MSDN - Manually process the data warehouse and analysis services cube for Team Foundation Server&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</a10:content></item><item><guid isPermaLink="true">http://nullfactory.net/2014/12/tfs-list-of-files-changed-between-changesets/</guid><link>http://nullfactory.net/2014/12/tfs-list-of-files-changed-between-changesets/</link><title>Get a list of files changed between changesets in Visual Studio Online using PowerShell</title><description>&lt;p&gt;So recently I had the requirement of getting a list of files that changed between two different releases. We wanted to use this list to act as a verification to ensure that all artifacts were included in a release package.&lt;/p&gt;

&lt;p&gt;I modified the code posted &lt;a href="https://social.msdn.microsoft.com/Forums/vstudio/en-US/f1a00836-cef3-419b-b768-3d1b6fa2b7bc/identifying-all-vb-files-changed-between-two-changesets?forum=tfsversioncontrol"&gt;here&lt;/a&gt; in order to quickly write a console application to do the task. With the immediate problem solved, my colleges and I bounced the idea about porting the code into a PowerShell script which would allow us to enhance it better in the long run.&lt;/p&gt;

&lt;h2&gt;Overview&lt;/h2&gt;

&lt;p&gt;The solution would be built around the Visual Studio Online(VSO) REST service. This reduces any dependency on Team Foundation Server(TFS) specific client side assemblies or tools. The limitation is that, at the moment, it is only supported in Visual Studio Online and not all features are supported.&lt;/p&gt;

</description><pubDate>Sat, 13 Dec 2014 18:30:00 Z</pubDate><a10:updated>2014-12-13T18:30:00Z</a10:updated><a10:content type="html">&lt;p&gt;So recently I had the requirement of getting a list of files that changed between two different releases. We wanted to use this list to act as a verification to ensure that all artifacts were included in a release package.&lt;/p&gt;

&lt;p&gt;I modified the code posted &lt;a href="https://social.msdn.microsoft.com/Forums/vstudio/en-US/f1a00836-cef3-419b-b768-3d1b6fa2b7bc/identifying-all-vb-files-changed-between-two-changesets?forum=tfsversioncontrol"&gt;here&lt;/a&gt; in order to quickly write a console application to do the task. With the immediate problem solved, my colleges and I bounced the idea about porting the code into a PowerShell script which would allow us to enhance it better in the long run.&lt;/p&gt;

&lt;h2&gt;Overview&lt;/h2&gt;

&lt;p&gt;The solution would be built around the Visual Studio Online(VSO) REST service. This reduces any dependency on Team Foundation Server(TFS) specific client side assemblies or tools. The limitation is that, at the moment, it is only supported in Visual Studio Online and not all features are supported.&lt;/p&gt;

&lt;!--excerpt--&gt;

&lt;h2&gt;Pre-Requisites&lt;/h2&gt;

&lt;h3&gt;Security and Credentials&lt;/h3&gt;

&lt;p&gt;In order make things simple, let's enable Alternate Authentication for access the account. This enables the script to use Basic Authentication when making request to the VSO REST service.
This can be done by navigating to the profile page, selecting &lt;code&gt;Credentials &amp;gt; Enable alternate credentials&lt;/code&gt; and providing new credential information. More instructions available &lt;a href="http://www.visualstudio.com/en-us/integrate/get-started/get-started-auth-introduction-vsi"&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The credentials will be collected using the &lt;code&gt;Get-Credentials&lt;/code&gt; &lt;a href="http://technet.microsoft.com/en-us/library/hh849815.aspx"&gt;cmdlet&lt;/a&gt;. This provides the standard windows credentials dialog for the user to enter information. Since this makes the script interactive, I debated about having the username and password as a parameter for the script, but in the end decided against it. Maybe the next improvement would be to include a silent version of the script.&lt;/p&gt;

&lt;h3&gt;The REST call&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;Invoke-RestMethod&lt;/code&gt; cmdlet will be used to make the actual call to the REST service. So what's the difference between &lt;code&gt;Invoke-WebRequest&lt;/code&gt; and &lt;code&gt;Invoke-RestMethod&lt;/code&gt; you may ask? While similar, the &lt;code&gt;Invoke-RestMethod&lt;/code&gt; attempts to parse the returned JSON so that we do not have to do it manually within our script. Think of it as a super set of &lt;code&gt;Invoke-WebRequest&lt;/code&gt; just like &lt;code&gt;Invoke-WebRequest&lt;/code&gt; is a superset of &lt;code&gt;System.Net.WebClient&lt;/code&gt;. Read more about it &lt;a href="http://jamesone111.wordpress.com/2014/06/09/screen-scraping-for-pleasure-or-profit-with-powershells-invoke-restmethod/"&gt;here&lt;/a&gt; and &lt;a href="http://blogs.technet.com/b/heyscriptingguy/archive/2013/10/21/invokerestmethod-for-the-rest-of-us.aspx"&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I ran into strange issue when attempting to authenticate the request. The&lt;br /&gt;
&lt;code&gt;Get-Credentials&lt;/code&gt; cmdlet would return a &lt;code&gt;System.Management.Automation.PSCredential&lt;/code&gt; object as expected, but when passed into into the &lt;code&gt;Invoke-RestMethod&lt;/code&gt; cmdlet, it was not generating the the basic authentication header token within the request. I still haven't figured out why this happens, but the workaround was to add the authentication header explicitly as &lt;a href="http://stuartpreston.net/2014/05/accessing-visual-studio-online-rest-api-using-powershell-4-0-invoke-restmethod-and-alternate-credentials/"&gt;shown here&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$basicAuth = ("{0}:{1}" -f $username,$password)
$basicAuth = [System.Text.Encoding]::UTF8.GetBytes($basicAuth)
$basicAuth = [System.Convert]::ToBase64String($basicAuth)
$headers = @{Authorization=("Basic {0}" -f $basicAuth)}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2&gt;Making the call to the service&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;First get a list of changesets related to the project within the timeframe that we're interested in.  &lt;/p&gt;

&lt;pre&gt;&lt;code&gt;https://{account}.visualstudio.com/defaultcollection/_apis/tfvc/changesets?api-version=1.0&amp;amp;searchCriteria.fromId=100&amp;amp;searchCriteria.toId=200&amp;amp;searchCriteria.itemPath=$/{project}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It took me a while to figure it out but you should notice this call is only allowed to be made against the entire Team Project Collection. So in order to filter out the project, provide the project path via the &lt;code&gt;searchCriteria.itemPath&lt;/code&gt; filter. That is &lt;code&gt;searchCriteria.itemPath=$/{projectname}&lt;/code&gt; where &lt;code&gt;{projectname}&lt;/code&gt; is the one that you are interested in.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Next iterate through each of the results to retrieve the detailed information on of each of the changesets. This result would include a collection of all the files that were affected.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;https://{account}.visualstudio.com/defaultcollection/_apis/tfvc/changesets/{changesetId}/changes?api-version=1.0
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Again, iterate through each of the changes and extract the &lt;code&gt;path&lt;/code&gt; property of the json result set. This is the path and name of the file.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Remove duplicates entries and folder creation entries as necessary.&lt;/li&gt;
&lt;/ol&gt;

&lt;h2&gt;Final Thoughts&lt;/h2&gt;

&lt;p&gt;You can download my implementation &lt;a href="https://github.com/shanec-/powershell/blob/master/TFS/Get-FilesModifiedByChangeset.ps1"&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The next steps would make this to its own cmdlet in order to make it more reusable in other scripts.
Also check out the &lt;a href="https://curah.microsoft.com/276618/list"&gt;Curah! page&lt;/a&gt; that I created while working on this.&lt;/p&gt;

&lt;h2&gt;References&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://social.msdn.microsoft.com/Forums/vstudio/en-US/f1a00836-cef3-419b-b768-3d1b6fa2b7bc/identifying-all-vb-files-changed-between-two-changesets?forum=tfsversioncontrol"&gt;Identifying all .vb files changed between two changesets&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://technet.microsoft.com/en-us/library/hh849815.aspx"&gt;Microsoft Technet - Get-Credential&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://jamesone111.wordpress.com/2014/06/09/screen-scraping-for-pleasure-or-profit-with-powershells-invoke-restmethod/"&gt;Screen scraping for pleasure or profit (with PowerShell’s Invoke-RestMethod)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://blogs.technet.com/b/heyscriptingguy/archive/2013/10/21/invokerestmethod-for-the-rest-of-us.aspx"&gt;Hey, Scripting Guy! - InvokeRestMethod for the Rest of Us&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://technet.microsoft.com/en-us/library/hh849971.aspx"&gt;Microsoft Technet - Invoke-RestMethod&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://stuartpreston.net/2014/05/accessing-visual-studio-online-rest-api-using-powershell-4-0-invoke-restmethod-and-alternate-credentials/"&gt;Accessing Visual Studio Online REST API using Powershell 4.0, Invoke-RestMethod and Alternate Credentials&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</a10:content></item><item><guid isPermaLink="true">http://nullfactory.net/2014/09/improved-performance-by-hosting-virtual-hard-disk-external-usb-drives/</guid><link>http://nullfactory.net/2014/09/improved-performance-by-hosting-virtual-hard-disk-external-usb-drives/</link><title>Improved Performance by Hosting Virtual Hard Disk External USB Drives</title><description>&lt;p&gt;I think I already knew this to be true, but didn't own a "portable enough" hard disk to lug around with my laptop to try it out myself.  That's about to change as I got myself new Western Digital My Passport Ultra today; its the perfect size both terms of capacity and dimensions. So now I get to try this out in a real world scenario.&lt;/p&gt;

&lt;h2&gt;Moving the Virtual Drive Images&lt;/h2&gt;

&lt;p&gt;The entire process entails moving the physical files to the new location and letting Hyper-V know about this move. If the virtual machine (VM) is already active it does not seem to be possible to move the checkpoint location.&lt;/p&gt;

</description><pubDate>Tue, 23 Sep 2014 18:30:00 Z</pubDate><a10:updated>2014-09-23T18:30:00Z</a10:updated><a10:content type="html">&lt;p&gt;I think I already knew this to be true, but didn't own a "portable enough" hard disk to lug around with my laptop to try it out myself.  That's about to change as I got myself new Western Digital My Passport Ultra today; its the perfect size both terms of capacity and dimensions. So now I get to try this out in a real world scenario.&lt;/p&gt;

&lt;h2&gt;Moving the Virtual Drive Images&lt;/h2&gt;

&lt;p&gt;The entire process entails moving the physical files to the new location and letting Hyper-V know about this move. If the virtual machine (VM) is already active it does not seem to be possible to move the checkpoint location.&lt;/p&gt;

&lt;!--excerpt--&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Open up the Hyper-V Management Console.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/VirtualHardDiskPerf/1_HyperVManager.png" alt="Hyper-V Management Console" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Create a checkpoint of the VM.&lt;/li&gt;
&lt;li&gt;Shutdown the VM.&lt;/li&gt;
&lt;li&gt;Next, navigate to the VM setting panel by right-clicking and selecting &lt;code&gt;Settings&lt;/code&gt; or select it from the right actions pane.&lt;/li&gt;
&lt;li&gt;On the settings panel, navigate to the &lt;code&gt;hardware &amp;gt; IDE Controller 0&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;Virtual hard disk&lt;/code&gt; text box shows the current location of the virtual drive.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/VirtualHardDiskPerf/2_HyperVSettings.png" alt="Virtual Machine Settings" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Copy the contents of this entire directory together with the snapshots to the new destination.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/VirtualHardDiskPerf/9_FolderLocation.png" alt="Copy Virtual Machine Files" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Change the &lt;code&gt;Virtual hard disk&lt;/code&gt; path to match the new location.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/VirtualHardDiskPerf/3_UpdatedHyperVSettings.png" alt="Updated Virtual Machine Settings" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;You would receive the following message warning of data loss:&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/VirtualHardDiskPerf/4_DataLossWarning.png" alt="Data Loss Warning" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Since a checkpoint was created initially, click on &lt;code&gt;Continue&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Click on &lt;code&gt;Ok&lt;/code&gt; and the following warning is shown. Click on &lt;code&gt;Continue&lt;/code&gt; as the warning not applicable to us.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/VirtualHardDiskPerf/5_DataLossWarning2.png" alt="Chain Breakage" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Start up the virtual machine.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Since I already have checkpoint snapshots of my VMs, Hyper-V did not allow me to change the location. I think I might be able to use symbolic links in order to trick the OS into using the new drive. I will try to explore techniques available in a future post.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/VirtualHardDiskPerf/6_CheckPointLocation.png" alt="Checkpoint Location" /&gt;&lt;/p&gt;

&lt;p&gt;The only time this has become an issue is when saving the state of the VM. This causes hyper-v to writes a significant amount to the primary drive. This is something I can live with for now.&lt;/p&gt;

&lt;h2&gt;Benchmarks&lt;/h2&gt;

&lt;p&gt;I decided to do a quick benchmark on the hard disk to satisfy my curiosity. I used CrystalDiskMark as it appears to be one of the more popular ones.&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/VirtualHardDiskPerf/7_WD_CrystalDiskMark.png" alt="My Passport Ultra CrystalDiskMark" /&gt;&lt;/p&gt;

&lt;p&gt;The numbers are on par with what's to be expected of the drive - here's a 33 gig VPC being copied over.  &lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/VirtualHardDiskPerf/8_WD_BasicFileCopy.png" alt="My Passport Ultra CrystalDiskMark" /&gt;&lt;/p&gt;

&lt;h2&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;While I do not have a conclusive way to prove that get I do get improved performance, my system does feels more responsive. My primary drive no longer chokes with 100% activity when working with multiple VMs.&lt;/p&gt;

&lt;h2&gt;Future Improvements&lt;/h2&gt;

&lt;p&gt;Setting up the operating system on a Solid State Drive (SSD) should be the next step in improving the overall system performance. Replacing the slow mechanical hard drive should in theory bring all kinds of performance improvements. And in order to get the maximum benefit of SSDs, one would need to think about strategies such as partitioning schemes in effectively segmenting data.&lt;/p&gt;

&lt;h2&gt;References&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="https://workinghardinit.wordpress.com/tag/avhdx/"&gt;Manually Merging Hyper-V Checkpoints&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://crystalmark.info/software/CrystalDiskMark/index-e.html"&gt;CrystalDiskMark&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://blog.danieljost.com/symbolic-links-save-space-ssd/"&gt;Using Symbolic Links to Save Space on Your SSD&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</a10:content></item><item><guid isPermaLink="true">http://nullfactory.net/2014/09/create-an-isolated-hyper-v-environment/</guid><link>http://nullfactory.net/2014/09/create-an-isolated-hyper-v-environment/</link><title>Create An Isolated Hyper-V Environment</title><description>&lt;p&gt;&lt;em&gt;Bad things may happen when you power up a virtualized Domain Controller on your laptop and connect it to the corporate network.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;This post focuses on building a self-contained, isolated virtual environment with internet connectivity.&lt;/p&gt;

&lt;p&gt;My colleague, Chaminda has a &lt;a href="http://chamindac.blogspot.com/2013/12/setup-virtual-environment-for-tfs-2013_19.html"&gt;detailed post&lt;/a&gt; on how to setup and isolated environment using virtual box. Go check it out if you would like to implement it via virtual box.  While virtual box is a good virtualization platform on its own right, I have grown accustomed to using Hyper-V in my day-job and has become a personal preference.&lt;/p&gt;

&lt;h2&gt;Hyper-V&lt;/h2&gt;

&lt;p&gt;My own environment is built around this &lt;a href="http://blogs.technet.com/b/askpfeplat/archive/2013/03/04/your-personal-isolated-lab-featuring-windows-8-hyper-v.aspx"&gt;excellent post&lt;/a&gt;. It details the entire process involved. While my own setup is identical to the above, I have taken into account the following caveats:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;As mentioned by one of the comments on the post, it is important to explicitly set the port to &lt;code&gt;eth0&lt;/code&gt; soon after flashing the image.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Port Forwarding - Even simple tasks like setting up share folders require that certain ports be accessible. Therefore this it is an important consideration when planning an isolated environment. Here are some of the services and ports I've used for my TFS environment:&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/IsolatedEnvironment/1_PortForwarding.png" alt="Port Forwarding" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3&gt;Setting up Routing&lt;/h3&gt;

&lt;p&gt;Even though I have my isolated environment, there are instances where I would like resource in my main network to have access to the internal network. Although port forwarding works to a certain degree, we run into its limitations very fast.&lt;/p&gt;

&lt;p&gt;This involves setting up routes on both out internal router as well as the external router under which the external resources exists.&lt;/p&gt;

</description><pubDate>Sun, 21 Sep 2014 18:30:00 Z</pubDate><a10:updated>2014-09-21T18:30:00Z</a10:updated><a10:content type="html">&lt;p&gt;&lt;em&gt;Bad things may happen when you power up a virtualized Domain Controller on your laptop and connect it to the corporate network.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;This post focuses on building a self-contained, isolated virtual environment with internet connectivity.&lt;/p&gt;

&lt;p&gt;My colleague, Chaminda has a &lt;a href="http://chamindac.blogspot.com/2013/12/setup-virtual-environment-for-tfs-2013_19.html"&gt;detailed post&lt;/a&gt; on how to setup and isolated environment using virtual box. Go check it out if you would like to implement it via virtual box.  While virtual box is a good virtualization platform on its own right, I have grown accustomed to using Hyper-V in my day-job and has become a personal preference.&lt;/p&gt;

&lt;h2&gt;Hyper-V&lt;/h2&gt;

&lt;p&gt;My own environment is built around this &lt;a href="http://blogs.technet.com/b/askpfeplat/archive/2013/03/04/your-personal-isolated-lab-featuring-windows-8-hyper-v.aspx"&gt;excellent post&lt;/a&gt;. It details the entire process involved. While my own setup is identical to the above, I have taken into account the following caveats:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;As mentioned by one of the comments on the post, it is important to explicitly set the port to &lt;code&gt;eth0&lt;/code&gt; soon after flashing the image.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Port Forwarding - Even simple tasks like setting up share folders require that certain ports be accessible. Therefore this it is an important consideration when planning an isolated environment. Here are some of the services and ports I've used for my TFS environment:&lt;/p&gt;

&lt;p&gt;&lt;img src="http://nullfactory.net/images/posts/IsolatedEnvironment/1_PortForwarding.png" alt="Port Forwarding" /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3&gt;Setting up Routing&lt;/h3&gt;

&lt;p&gt;Even though I have my isolated environment, there are instances where I would like resource in my main network to have access to the internal network. Although port forwarding works to a certain degree, we run into its limitations very fast.&lt;/p&gt;

&lt;p&gt;This involves setting up routes on both out internal router as well as the external router under which the external resources exists.&lt;/p&gt;

&lt;!--excerpt--&gt;  

&lt;h2&gt;References&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://blogs.technet.com/b/askpfeplat/archive/2013/03/04/your-personal-isolated-lab-featuring-windows-8-hyper-v.aspx"&gt;Your Personal Isolated Lab - Featuring Windows 8 + Hyper-V&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://chamindac.blogspot.com/2013/12/setup-virtual-environment-for-tfs-2013_19.html"&gt;Create a PDC in an Isolated Internal Network - Setup Virtual Environment for TFS 2013 - Using Virtualbox&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://technet.microsoft.com/en-us/library/cc731402.aspx"&gt;Understanding Shared Folders and the Windows Firewall&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</a10:content></item><item><guid isPermaLink="true">http://nullfactory.net/2014/09/powershell/</guid><link>http://nullfactory.net/2014/09/powershell/</link><title>Extract YouTube direct video url via Powershell</title><description>&lt;p&gt;It's been a while since I've have had the opportunity to write any powershell. So I decided to do something before my muscle memory atrophies completely.&lt;/p&gt;

&lt;p&gt;While I could not come up with a new problem to solve, I decided to re-visit my attempt at extracting the direct download url from a streaming service.I believe this is my 3rd attempt and its fast becoming my version of a "hello world" application. :)&lt;/p&gt;

&lt;p&gt;Previously, I tried to implement and parse out the urls by myself. This version is not going to be as complex as I will be using the &lt;a href="http://www.keepvid.com"&gt;keepvid.com&lt;/a&gt; to do the heavy lifting.&lt;/p&gt;

</description><pubDate>Sat, 20 Sep 2014 18:30:00 Z</pubDate><a10:updated>2014-09-20T18:30:00Z</a10:updated><a10:content type="html">&lt;p&gt;It's been a while since I've have had the opportunity to write any powershell. So I decided to do something before my muscle memory atrophies completely.&lt;/p&gt;

&lt;p&gt;While I could not come up with a new problem to solve, I decided to re-visit my attempt at extracting the direct download url from a streaming service.I believe this is my 3rd attempt and its fast becoming my version of a "hello world" application. :)&lt;/p&gt;

&lt;p&gt;Previously, I tried to implement and parse out the urls by myself. This version is not going to be as complex as I will be using the &lt;a href="http://www.keepvid.com"&gt;keepvid.com&lt;/a&gt; to do the heavy lifting.&lt;/p&gt;

&lt;!--excerpt--&gt;

&lt;p&gt;Here is a list of the steps:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Execute the script by either providing a space delimited list of video urls or location to a file containing the list of urls (one url per line).&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.\Get-DirectVideoUrl.ps1 -url -filename "C:\downloadlist.txt"
.\Get-DirectVideoUrl.ps1 -url "http://www.youtube.com/watch?v=duKL2dAJN6I http://www.youtube.com/watch?v=R4ajQ-foj2Q"
.\Get-DirectVideoUrl.ps1 -url "http://www.youtube.com/watch?v=duKL2dAJN6I http://www.youtube.com/watch?v=R4ajQ-foj2Q" -filename "C:\downloadlist.txt"
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The script formats the url appropriate for the service and sends out the request.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Once the response is received, the html is parsed out using XPath with the help of the HtmlAgilityPack library. (while this could have been done without the additional dependency, I opted to use it in the hopes that future enhancements would be easier)&lt;/li&gt;
&lt;li&gt;Repeat the process for all the input video urls that have been provided.&lt;/li&gt;
&lt;li&gt;Save all the urls to a text file.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Now that you have the final urls, it can batch imported into a download accelerator such as &lt;a href="http://nullfactory.net/www.freedownloadmanager.org/"&gt;FDM&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;While I only tested the script against the YouTube service I am sure this should work with any of the other video services supported by keepvid.com&lt;/p&gt;

&lt;p&gt;The script is hosted &lt;a href="https://github.com/shanec-/powershell/tree/master/Get-DirectVideoUrl"&gt;here&lt;/a&gt;, feel free to let me know your throughts.&lt;/p&gt;

&lt;p&gt;Same disclaimer applies to this post as per my previous attempts. This was written for educational purposes and I am pretty sure that it is violating the TOS video streaming service or keepvid itself. Therefore please use at your own discretion.&lt;/p&gt;
</a10:content></item></channel></rss>