
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>the nullfactory</title>
	<meta name="description" content="the nullfactory">
	<meta name="keywords" content="ALM,Azure,Azure Storage Accounts,CDN,Code Access Security,Deployment,Dynamics CRM,Dynamics CRM Online,Entity Framework,generator-nullfactory-xrm,Git,HtmlAgilityPack,Hyper-V,Log4Net,Mobile Development,nodejs,npm,PowerShell,REST,Security,SharePoint,SQL Server,SQL Server Data Tools,SQL Server Reporting Services,Team Build,Team Foundation Server,TFS Tips,Virtualization,Visual Studio Team Services,Windows,Windows Phone,Yeoman" />

	<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="the nullfactory" Feed">
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" href="http://www.nullfactory.net/stylesheets/base.css" type="text/css" />
	<link rel="stylesheet" href="http://www.nullfactory.net/stylesheets/github.css" type="text/css" />
	<link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://www.nullfactory.net/stylesheets/octicons.css" type="text/css" />
  <link rel="stylesheet" type="text/css" href="http://www.nullfactory.net/stylesheets/font-awesome/css/font-awesome.min.css" />
	<link rel="canonical" href="http://nullfactory.net/" />
</head>
<body>
  <!-- header -->

	<div class="header-container">
	  <header>
		  <ul class="nav">
			<!--Change the  URL here if working on an absolute domain-->
			<li><a href="http://www.nullfactory.net"><span class="mega-octicon octicon-terminal" style="margin-right: 6px;"></span>the nullfactory</a></li>
			<li><a href="http://www.nullfactory.net/archive"><span class="mega-octicon octicon-book" style="margin-right: 6px;"></span>archive</a></li>
			<li><a href="http://www.nullfactory.net/about"><span class="mega-octicon octicon-person" style="margin-right: 6px;"></span>about</a></li>
		  </ul>
	  </header>
	</div>

  <!-- header -->

  <div class="container">
	
<header>
  <div class="head-inner">
    <!--<h2>&nbsp;</h2>-->
  </div>
</header>
 <div class="listing">
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2016/11/release-strategy-for-dynamics-crm-setting-up-the-release-part-3/">Release Strategy for Dynamics CRM - Part 3 - Setting Up the Release</a></h2>
      <p class="post-date">18 Nov 2016

      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/dynamics-crm-online" title="Dynamics CRM Online">Dynamics CRM Online</a>
      | <a href="/category/generator-nullfactory-xrm" title="generator-nullfactory-xrm">generator-nullfactory-xrm</a>
      | <a href="/category/visual-studio-team-services" title="Visual Studio Team Services">Visual Studio Team Services</a>
</p>

      <p>
		
		<p>This is the final installment of the a three part series. Use to following links to access part 1 and 2:</p>

<ul>
<li><a href="/2016/10/release-strategy-for-dynamics-crm-prepping-part-1/">Release Strategy for Dynamics CRM - Part 1 - Preparation</a></li>
<li><a href="/2016/11/release-strategy-for-dynamics-crm-setting-up-the-build-part-2">Release Strategy for Dynamics CRM - Part 2 - Setting Up the Build</a></li>
<li>Release Strategy for Dynamics CRM - Part 3 - Setting Up the Release</li>
</ul>

<p>In the previous two posts I show you how to create the project structure and create a basic team build for your CRM solution artifacts. In this final installment I go about setting up a release definition for the build that we created.</p>

<ol>
<li>Let's start off by creating a new release by navigating to the <code>Build and Release &gt; Release</code> in your team project.</li>
<li><p>Select the <code>Empty</code> template option and click the next button.</p>

<p><img src="/images/posts/CrmReleasePt3/10_ReleaseDefinition.png" alt="Empty release template" /></p></li>
<li><p>On the next step, choose the source for this release - we'll be using the <a href="/2016/11/release-strategy-for-dynamics-crm-setting-up-the-build-part-2">build definition that we created in part 2</a>. Once ready click the <code>Create</code> button.</p>

<p><img src="/images/posts/CrmReleasePt3/20_SelectBuildDefinition.png" alt="Select build defintion" /></p></li>
<li><p>Now lets declare the variables that would be used later in the process. Navigate to the <code>Variables</code> tab and define the following variables:</p>

<ul>
<li><code>DevDeployLogin</code> - The username that used to deploy the solution.</li>
<li><code>DevDeployPassword</code> - The password for the same account.</li>
</ul>

<p>Make sure to define the <code>DevDeployPassword</code> as a secret by clicking the padlock icon next to the field.</p>

<p><img src="/images/posts/CrmReleasePt3/100_SetupVariables.png" alt="Release Variables" /></p>

<p>Read more about <a href="https://www.visualstudio.com/en-us/docs/build/define/variables">build and release variables here</a>.</p></li>
</ol>


		<p><a href="/2016/11/release-strategy-for-dynamics-crm-setting-up-the-release-part-3/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2016/11/release-strategy-for-dynamics-crm-setting-up-the-build-part-2/">Release Strategy for Dynamics CRM - Part 2 - Setting Up the Build</a></h2>
      <p class="post-date">12 Nov 2016

      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/dynamics-crm-online" title="Dynamics CRM Online">Dynamics CRM Online</a>
      | <a href="/category/generator-nullfactory-xrm" title="generator-nullfactory-xrm">generator-nullfactory-xrm</a>
      | <a href="/category/visual-studio-team-services" title="Visual Studio Team Services">Visual Studio Team Services</a>
</p>

      <p>
		
		<p>This is the second of a three part series in which I walk through setting up a release management strategy for Dynamics CRM.</p>

<ul>
<li><a href="/2016/10/release-strategy-for-dynamics-crm-prepping-part-1/">Release Strategy for Dynamics CRM - Part 1 - Preparation</a></li>
<li>Release Strategy for Dynamics CRM - Part 2 - Setting Up the Build</li>
<li><a href="/2016/11/release-strategy-for-dynamics-crm-setting-up-the-release-part-3/">Release Strategy for Dynamics CRM - Part 3 - Setting Up the Release</a></li>
</ul>

<p>In first part of the series accomplished the following:</p>

<ol>
<li>Setup the project structure using the <code>nullfactory-xrm</code> yeoman generator.    </li>
<li>Download the CRM solution from the remote server and unpacked it using the solution packager tool.</li>
<li>Checked-in all the artifacts back into Visual Studio Team Services (VSTS) source control.</li>
</ol>

<p>In this post I describe the steps required for setting up a team build. One of the goals with the generated project structure was to have it work with team builds with the least amount configuration. </p>

<h2>Setting Up the Team Build</h2>

<ol>
<li><p>Navigate to the <code>Build and Release &gt; Builds</code> from within the VSTS team project.</p>

<p><img src="/images/posts/CrmReleasePt2/10_NewDefintion.png" alt="Build and Release Menue" /></p></li>
<li><p>Create a new build definition using a vanilla <code>Visual Studio</code> template.</p>

<p><img src="/images/posts/CrmReleasePt2/20_SelectBuildTemplate.png" alt="Visual Studio Template" /></p></li>
</ol>


		<p><a href="/2016/11/release-strategy-for-dynamics-crm-setting-up-the-build-part-2/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2016/10/release-strategy-for-dynamics-crm-prepping-part-1/">Release Strategy for Dynamics CRM - Part 1 - Preparation</a></h2>
      <p class="post-date">30 Oct 2016

      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/dynamics-crm-online" title="Dynamics CRM Online">Dynamics CRM Online</a>
      | <a href="/category/generator-nullfactory-xrm" title="generator-nullfactory-xrm">generator-nullfactory-xrm</a>
      | <a href="/category/visual-studio-team-services" title="Visual Studio Team Services">Visual Studio Team Services</a>
      | <a href="/category/git" title="Git">Git</a>
</p>

      <p>
		
		<p>Earlier this year I demonstrated the strategy I use for maintaining CRM solutions in source control. I favor the approach due to its ability to be used in team builds and automated releases. Since my original post, I have created a yeoman generator that allows to quickly scaffold the project structure for new projects. And now, in this series of posts, I will walk you through the steps in setting up a new project, creating a team build finally implementing a release strategy using Visual Studio Team Services. </p>

<ul>
<li>Release Strategy for Dynamics CRM - Part 1 - Preparation</li>
<li><a href="/2016/11/release-strategy-for-dynamics-crm-setting-up-the-build-part-2">Release Strategy for Dynamics CRM - Part 2 - Setting Up the Build</a></li>
<li><a href="/2016/11/release-strategy-for-dynamics-crm-setting-up-the-release-part-3/">Release Strategy for Dynamics CRM - Part 3 - Setting Up the Release</a></li>
</ul>

<p>In order to automate the process we first need to make sure that the solution is maintained in source control. </p>

<h2>Prerequistes</h2>

<ul>
<li>Visual Studio Team System (VSTS) source control.</li>
<li><code>Yeoman</code> code generator with the <code>generator-nullfactory-xrm</code> installed globally. Installation instructions can be found <a href="https://www.npmjs.com/package/generator-nullfactory-xrm">here</a>.</li>
</ul>

<p>While in this particular demo I use a VSTS team project running on top of Git source control along with VSTS Release Management for the deployment, the same steps can be adapted to be used with any other build and release system.</p>

<h2>Prepping the Solution</h2>

<ol>
<li>Create a Team Project and select <code>Git</code> as the version control.</li>
<li>Clone a working copy onto a local machine. </li>
<li>Create a .gitignore file that excludes build output - let's use <a href="https://github.com/github/gitignore/blob/master/VisualStudio.gitignore">GitHub's definitions for Visual Studio</a>.</li>
<li><p>Run the <code>nullfactory-xrm</code> yeoman generator in order to scaffold the project structure. More detailed instructions on running the generator can be found <a href="https://www.npmjs.com/package/generator-nullfactory-xrm">here</a>.</p>

<p><img src="/images/posts/CrmReleasePt1/10_YoGenerator.png" alt="nullfactory-xrm yo generator" /></p></li>
</ol>


		<p><a href="/2016/10/release-strategy-for-dynamics-crm-prepping-part-1/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2016/09/yeoman-generator-for-dynamics-crm-solutions/">Yeoman Generator For Dynamics CRM Solutions</a></h2>
      <p class="post-date">15 Sep 2016

      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/dynamics-crm-online" title="Dynamics CRM Online">Dynamics CRM Online</a>
      | <a href="/category/yeoman" title="Yeoman">Yeoman</a>
      | <a href="/category/npm" title="npm">npm</a>
      | <a href="/category/nodejs" title="nodejs">nodejs</a>
      | <a href="/category/generator-nullfactory-xrm" title="generator-nullfactory-xrm">generator-nullfactory-xrm</a>
</p>

      <p>
		
		<p>I've previously experimented on creating a simplified way of <a href="/2016/01/crm-solution-tfs-microsoft-xrm-data-powershell/">maintaining CRM solutions in source control</a>. While I was quite happy with the end result, the process of setting up the projects, scripts and post-build steps was a little bit tedious. </p>

<p>This is where Yeoman code generator comes in. Yeoman is a very popular javascript based scaffolding engine that enables setting up new projects a breeze. I created my own custom generator that would help me to kick start new CRM solutions quickly. You can find the end product here: <a href="https://www.npmjs.com/package/generator-nullfactory-xrm">https://www.npmjs.com/package/generator-nullfactory-xrm</a></p>

<h2>Installation</h2>

<p>First, install <a href="http://yeoman.io">Yeoman</a> and generator-nullfactory-xrm using <a href="https://www.npmjs.com/">npm</a>.</p>

<pre><code>npm install -g yo
npm install -g generator-nullfactory-xrm
</code></pre>

<p>Then generate your new project:</p>

<pre><code>yo nullfactory-xrm
</code></pre>

<h2>Execution</h2>

<p>Template questions and their purpose:</p>

<ol>
<li>Visual Studio solution file name?  <code>The visual studio solution filename.</code></li>
<li>Visual Studio project prefix?  <code>The prefix for the projects generated. This can be an organization name or preferred convention.</code></li>
<li>Source CRM server url? <code>This is the source CRM server url. Example:[https://sndbx.crm6.dynamics.com](https://sndbx.crm6.dynamics.com)</code></li>
<li>Source CRM Username? <code>The username used to connect to the source CRM server.</code></li>
<li>Source CRM Password? <code>The password for the above account.</code></li>
<li>Source CRM Solution Name? <code>The name of the CRM solution to be extracted.</code></li>
<li>Add *.WebResource project? <code>Specifies if a new project should be created to manage the web resouces.</code></li>
<li>Add *.Plugin project? <code>Specifies if a new plugin project should be created.</code></li>
</ol>


		<p><a href="/2016/09/yeoman-generator-for-dynamics-crm-solutions/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2016/07/unable-to-qualify-lead/">Unable to Qualify Lead</a></h2>
      <p class="post-date">23 Jul 2016

      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/dynamics-crm-online" title="Dynamics CRM Online">Dynamics CRM Online</a>
</p>

      <p>
		
		<p>I was investigating an issue in a customized Dynamics CRM environment where the "Qualify" ribbon button on the Lead record had mysteriously stopped working. </p>

<p>Qualification from the grid and the organization service API appeared to work as expected, and this only seemed limited to the ribbon button. Given that the page was not even posting back to the server on clicking the button, I suspected it was failing at the front end. I fired up the chrome developer tools and sure enough was greeted with the following error on the console:</p>

<p><img src="/images/posts/UnableToQualifyLead/10_error-message.png" alt="Developer Tools Error Message" /></p>


		<p><a href="/2016/07/unable-to-qualify-lead/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2016/04/checklist-enabling-quick-create-subgrid/">Checklist for Enabling Quick Create from Sub-grid</a></h2>
      <p class="post-date">17 Apr 2016

      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/dynamics-crm-online" title="Dynamics CRM Online">Dynamics CRM Online</a>
</p>

      <p>
		
		<p>There have been a few instances where I've wanted to launch a quick create a record directly from a sub-grid add-button. That is, without having an extra step of bringing down the lookup view and then clicking the <code>+ New</code> button. </p>

<p><img src="/images/posts/QuickCreateSubGrid/10_ExpectedResult.png" alt="The expected result" /></p>

<p>While the required steps are covered between these two great posts - <a href="http://ledgeviewpartners.com/blog/manage-quick-create-forms-dynamics-crm/">here</a> and <a href="http://www.powerobjects.com/2015/03/10/open-quick-create-sub-grid/">here</a>, I have summarized the checklist here for convenience.</p>


		<p><a href="/2016/04/checklist-enabling-quick-create-subgrid/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2016/04/non-searchable-field-breaks-pre-filtering/">Non-searchable Primary Key Field Breaks Pre-filtering</a></h2>
      <p class="post-date">16 Apr 2016

      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/dynamics-crm-online" title="Dynamics CRM Online">Dynamics CRM Online</a>
</p>

      <p>
		
		<p>I recently implemented a custom FetchXml based SSRS report that was designed to be run against a filtered list of accounts. The accounts were to be determined by the user at the time of execution, hence the report was setup to use pre-filtering on the accounts entity.</p>

<p>The report worked fine except in one environment where the user was greeted with the following warning message:</p>

<p><img src="/images/posts/PreFilterNonSearchable/10_FilteringError.png" alt="Filtering error" /></p>

<p>Dismissing the warning opened up the <code>Report Filtering Criteria</code> dialog with the following error:</p>

<pre><code>There was an error in showing this condition
</code></pre>

<p>And additional information:</p>

<pre><code>The condition was referencing the field accountid. The field has been removed from the system or is not valid for advanced find.
</code></pre>

<p><img src="/images/posts/PreFilterNonSearchable/20_ReportFilteringCriteria.png" alt="Report filtering criteria" /></p>


		<p><a href="/2016/04/non-searchable-field-breaks-pre-filtering/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2016/04/dynamics-crm-base64-attachment-size/">Base64 and Maximum Attachment Size in Dynamics CRM</a></h2>
      <p class="post-date">15 Apr 2016

      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/dynamics-crm-online" title="Dynamics CRM Online">Dynamics CRM Online</a>
</p>

      <p>
		
		<p>Microsoft Dynamics CRM provides out-of-the-box functionality to store and associate small file attachments against an entity record. This is achieved via the <code>annotation</code> entity - it is similar to any other entity except that it stores meta data as well as the <a href="https://msdn.microsoft.com/en-us/library/gg334398.aspx">actual content of the file attachment</a> within it. </p>

<p>As CRM is not designed to be a <a href="http://www.optimalcrm.co.uk/storage-limit-reached-in-microsoft-dynamics-crm-online/">file store</a>, it imposes some limitations on the size of attachments that can be uploaded. Recent versions of the product, including 2016, defaults this size to 5120Kb which can be adjusted to a <a href="https://dynamicscrmherald.wordpress.com/2014/01/03/increasing-web-resource-and-email-note-attachment-file-size-in-microsoft-dynamics-crm-2013/">maximum hard limit of 32768Kb</a>. </p>

<p>However, there is one caveat with this limitation - CRM stores the byte stream in a base64 encoded format, this means that there would be an <a href="http://stackoverflow.com/questions/4715415/base64-what-is-the-worst-possible-increase-in-space-usage">increase</a> in the final saved file size. </p>


		<p><a href="/2016/04/dynamics-crm-base64-attachment-size/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2016/01/crm-solution-tfs-microsoft-xrm-data-powershell/">Strategy for Maintaining CRM Solutions in Team Foundation Server using Microsoft.Xrm.Data.PowerShell</a></h2>
      <p class="post-date">21 Jan 2016

      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/team-foundation-server" title="Team Foundation Server">Team Foundation Server</a>
      | <a href="/category/alm" title="ALM">ALM</a>
</p>

      <p>
		
		<p>I've come across a few strategies on the internet on achieving this goal, with each one having its pros and cons. This post describes my own attempt at setting up a development workflow that can be integrated with the team builds.</p>

<p>This implementation at its core revolves around the <a href="https://github.com/seanmcne/Microsoft.Xrm.Data.PowerShell"><code>Microsoft.Xrm.Data.PowerShell</code></a> module and the <code>Solution Packager</code> tool provided with the official SDK. I have minimized the use of 3rd party libraries and have intentionally excluded the use of any visual studio extensions or helper tools.</p>

<h2>Setting up the Tools</h2>

<h3>Installing Microsoft.CrmSdk.CoreTools</h3>

<p>Let's start off by creating a "tooling" project that would act as a hosts for the tools and scripts involved in the process.</p>

<ol>
<li>Create a class library project to host the tools using for building the packages. I named mine <code>Nullfactory.Crm.Tooling</code>.</li>
<li><p>Install the <code>Microsoft.CrmSdk.CoreTools</code> nuget package by running the following command in the package manager console: </p>

<p><code>Install-Package Microsoft.CrmSdk.CoreTools -Project Nullfactory.Crm.Tooling</code></p>

<p>This nuget package includes the <code>SolutionPackager.exe</code> tool.</p>

<p><img src="/images/posts/CrmDataPowershell/10_InstallCoreTools.png" alt="Install Crm Core Tools" /></p></li>
<li><p>Next, clean up the project by removing the default <code>Class1.cs</code> file as well as the <code>Debug</code> and <code>Release</code> within the <code>bin</code> folder.</p></li>
<li><p>Update the solution configurations to not build this project. Do this by navigating to the solution property pages > <code>Configuration Properties</code> and un-ticking the check box against the build column.</p>

<p><img src="/images/posts/CrmDataPowershell/20_DontBuild.png" alt="Do not Build Project" /></p></li>
</ol>


		<p><a href="/2016/01/crm-solution-tfs-microsoft-xrm-data-powershell/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2015/12/disabling-recurring-ondemand-webjob/">Disabling Recurring and OnDemand Web Jobs within a Deployment Slot</a></h2>
      <p class="post-date">20 Dec 2015

      | <a href="/category/azure" title="Azure">Azure</a>
</p>

      <p>
		
		<p>I've come to realize that things can get a bit tricky when working with slot deployments and webjobs. I learned <em>the hard way</em> that stopping a slotted Web App does <strong>not</strong> stop the web jobs it hosts. This means that I can't just stop all my website slots and expect the related jobs to automatically shutdown as well. Bummer. 
Okay, so I am thinking maybe I'll just disable the individual jobs for each of the slots? Not much luck on that front either as the Azure portal only provides a <code>stop</code> option for <code>continuous</code> jobs and not for the <code>recurring</code> and <code>OnDemand</code> jobs.</p>

<p>This limits us to a few possible solutions:</p>


		<p><a href="/2015/12/disabling-recurring-ondemand-webjob/">Read more...</a></p>
	  </p>
    </div>
</div>

  <div id="post-pagination" class="pagination">



      <!--<a href="/">Previous Page</a>-->

    <p class="previous">
      <a href="/page2">Next Page</a>
    </p>

  </div>

  </div>

  <!-- /.main -->

  <script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(['_setAccount', 'UA-57983893-1']);
_gaq.push(['_trackPageview']);
        
(function () {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
})();
</script>
</body>
</html>
