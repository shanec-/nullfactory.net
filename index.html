
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>the nullfactory</title>
	<meta name="description" content="the nullfactory">
	<meta name="keywords" content="ALM,Azure,Azure Storage Accounts,CDN,Code Access Security,commitizen,conventional-changelog,Deployment,Dynamics CRM,Dynamics CRM Online,Entity Framework,generator-nullfactory-xrm,Git,HtmlAgilityPack,Hyper-V,Log4Net,Miscellaneous,Mobile Development,nodejs,npm,Octopus Deploy,PowerShell,REST,Security,SharePoint,SOAP,SQL Server,SQL Server Data Tools,SQL Server Reporting Services,StyleCop,Team Build,Team Foundation Server,TFS Tips,TFSVC,Virtualization,Visual Studio,Visual Studio Team Services,WCF,Windows,Windows Phone,Yeoman" />

	<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="the nullfactory" Feed">
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" href="http://www.nullfactory.net/stylesheets/base.css" type="text/css" />
	<link rel="stylesheet" href="http://www.nullfactory.net/stylesheets/github.css" type="text/css" />
	<link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://www.nullfactory.net/stylesheets/octicons.css" type="text/css" />
  <link rel="stylesheet" type="text/css" href="http://www.nullfactory.net/stylesheets/font-awesome/css/font-awesome.min.css" />
	<link rel="canonical" href="http://nullfactory.net/" />
</head>
<body>
  <!-- header -->

	<div class="header-container">
	  <header>
		  <ul class="nav">
			<!--Change the  URL here if working on an absolute domain-->
			<li><a href="http://www.nullfactory.net"><span class="mega-octicon octicon-terminal" style="margin-right: 6px;"></span>the nullfactory</a></li>
			<li><a href="http://www.nullfactory.net/archive"><span class="mega-octicon octicon-book" style="margin-right: 6px;"></span>archive</a></li>
			<li><a href="http://www.nullfactory.net/about"><span class="mega-octicon octicon-person" style="margin-right: 6px;"></span>about</a></li>
		  </ul>
	  </header>
	</div>

  <!-- header -->

  <div class="container">
	
<header>
  <div class="head-inner">
    <!--<h2>&nbsp;</h2>-->
  </div>
</header>
 <div class="listing">
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2018/01/build-pipeline-as-code-yaml-based-ci-build-for-dynamics-365-solutions/">Build Pipeline as Code - YAML based CI Build for Dynamics 365 Solutions</a></h2>
      <p class="post-date">20 Jan 2018

      | <a href="/category/visual-studio-team-services" title="Visual Studio Team Services">Visual Studio Team Services</a>
      | <a href="/category/git" title="Git">Git</a>
      | <a href="/category/alm" title="ALM">ALM</a>
      | <a href="/category/dynamics-crm-online" title="Dynamics CRM Online">Dynamics CRM Online</a>
      | <a href="/category/generator-nullfactory-xrm" title="generator-nullfactory-xrm">generator-nullfactory-xrm</a>
</p>

      <p>
		
		<p>I first learned about YAML builds a while back when I was trying into integrate a project with AppVeyor. The concept of treating your build pipeline as first class code artefact was very appealing as it opens up so much possibilities. For me personally the highlights are: </p>

<ul>
<li>History, versioning and branching of your build definitions</li>
<li>Improve quality of build definitions and consistency across projects.</li>
<li>Quickly reuse and repurpose builds onto different projects.</li>
<li>Make maximum use of the underlying build platform.</li>
</ul>

<p>These posts <a href="https://blog.kloud.com.au/2017/11/26/vsts-build-definitions-as-yaml-part-1-what-and-why/">here</a> and <a href="https://www.marcusfelling.com/blog/2017/vsts-yaml-builds/">here</a> dive deeper into the advantages and the different use cases.  </p>

<p>A couple of months ago the Visual Studio Team Service (VSTS) team <a href="https://blogs.msdn.microsoft.com/devops/2017/11/15/pipeline-as-code-yaml-preview/">announced</a> support for the the same functionality in VSTS. Although the feature is still in preview, the VSTS team has continued to improve the feature and now provides the ability to export existing build definitions or individual tasks. In this post, I intend to take pre-existing build definition, converting it to a YAML build definition and make the necessary changes to get it to work as a CI build. </p>

<p>In this post, I intend to port an existing definition to a YAML build definition and use it as a template to setup a new CI build for a second project. The source definition that I will be using is a basic version I use for Dynamics 365 projects. </p>


		<p><a href="/2018/01/build-pipeline-as-code-yaml-based-ci-build-for-dynamics-365-solutions/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2017/10/crm-saturday-melbourne-2017-presentation-slide-deck/">CRM Saturday Melbourne 2017 - Presentation Slide Deck</a></h2>
      <p class="post-date">09 Oct 2017

      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/generator-nullfactory-xrm" title="generator-nullfactory-xrm">generator-nullfactory-xrm</a>
      | <a href="/category/miscellaneous" title="Miscellaneous">Miscellaneous</a>
</p>

      <p>
		
		<p><a href="https://www.slideshare.net/shanec_/zero-to-devops-source-control-release-strategy-crm-saturday-2017"><img src="/images/posts/CrmSatSlideDeck/crm-sat-slide-deck.png" alt="CRM Saturday Melbourne 2017" /></a></p>

<p>I know its a "little" late, but here's the slide deck from my CRM Saturday 2017 presentation  - <code>Zero to DevOps - Source Control and Release Strategy for Dynamics 365 Solutions</code>. </p>


		<p><a href="/2017/10/crm-saturday-melbourne-2017-presentation-slide-deck/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2017/10/dont-forget-to-install-the-just-in-time-debugger/">Don't Forget to Install the Just-In-Time Debugger</a></h2>
      <p class="post-date">08 Oct 2017

      | <a href="/category/visual-studio" title="Visual Studio">Visual Studio</a>
      | <a href="/category/miscellaneous" title="Miscellaneous">Miscellaneous</a>
</p>

      <p>
		
		<p>Today I learned that you can have an installation of Visual Studio 2017 without the JIT debugger - Yup, you really can.  This meant that I could not use the technique of attaching a debugger at runtime using the  <code>System.Diagnostics.Debugger.Launch();</code> code snippet. </p>

<p>When the application executes the launch code, nothing happens - no error nor exception. The method even returns <code>true</code> indicating a a successful launch.</p>


		<p><a href="/2017/10/dont-forget-to-install-the-just-in-time-debugger/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2017/10/tail-using-powershell/">Tail using PowerShell</a></h2>
      <p class="post-date">07 Oct 2017

      | <a href="/category/powershell" title="PowerShell">PowerShell</a>
</p>

      <p>
		
		<p>Consider a scenario where you are diagnosing an issue on a production server. You've enabled the logs and got everything setup to reproduce the issue. Queue the trigger to invoke the misbehaving operation and finally wait for the log file to update.</p>

<p>Staring at the log file size to change is no fun nor is refreshing the file periodically. I want to be notified the moment the log gets updated in real-time. This is exactly what a program like <a href="https://en.wikipedia.org/wiki/Tail_(Unix)"><code>tail</code></a> does - it monitors the file for changes and outputs the <em>tail</em> end of the file.</p>

<p>There are a few incarnations of tail out there that do the job perfectly fine, but given that this was a production environment I was not keep about installing new tools.</p>

<p>Luckily, the <code>Get-Content</code> PowerShell cmdlet has this functionality built-in. This is the combo that I finally settled on:</p>


		<p><a href="/2017/10/tail-using-powershell/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2017/10/mocking-and-testing-a-webservice-using-soapui/">Mocking and Testing a WebService using SoapUI</a></h2>
      <p class="post-date">06 Oct 2017

      | <a href="/category/rest" title="REST">REST</a>
      | <a href="/category/soap" title="SOAP">SOAP</a>
      | <a href="/category/wcf" title="WCF">WCF</a>
</p>

      <p>
		
		<p>I have recently been working on an implementation of a WCF client interacts with a remote SOAP web service. Unfortunately this service did not have a development version that I could interactively test my requests against.</p>

<p>Armed with just the WSDL and the schema for expected responses, I needed to find a way to mock the remote service in order to confirm the functionality of the client. This is where SOAP UI comes in - SOAP UI is tool that allows me to point it to service contract (WSDL or REST) and mock the responses that each of the actions would generate. And finally provides the functionality to host and serve these mocked responses so that they can be consumed by different clients.</p>

<p>I will be using the freely available <a href="http://www.webservicex.net/globalweather.asmx">http://www.webservicex.net/globalweather.asmx</a> web service to demonstrate the process.</p>


		<p><a href="/2017/10/mocking-and-testing-a-webservice-using-soapui/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2017/06/continuous-integration-and-continuous-delivery-of-dynamics-365-solutions-using-vsts/">Continuous Integration and Continuous Delivery of Dynamics 365 Solutions using VSTS</a></h2>
      <p class="post-date">25 Jun 2017

      | <a href="/category/alm" title="ALM">ALM</a>
      | <a href="/category/visual-studio-team-services" title="Visual Studio Team Services">Visual Studio Team Services</a>
      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/dynamics-crm-online" title="Dynamics CRM Online">Dynamics CRM Online</a>
      | <a href="/category/git" title="Git">Git</a>
</p>

      <p>
		
		<p>In previous posts I've setup build and release defintions for Dynamics CRM solutions and in this one I try my attempt at setting up an automated Continuous Delivery pipeline. There are two popular strategies used to make sure that <a href="https://puppet.com/blog/continuous-delivery-vs-continuous-deployment-what-s-diff">every change made to a system can be deployed</a> successfully to secondary environment:</p>

<ul>
<li><p>Continuous Integration (CI)</p>

<p>A CI build is one that is usually kicked off any time a piece of code is checked-in in order to give early visibility of any potential failures. The success of a build is dependent on the actual build plus any unit tests.</p></li>
<li><p>Scheduled</p>

<p>A scheduled build, also commonly referred to as a <code>Nightly Build</code>, is a build and release that is performed on a regular cadence - usually every night. Once again, on the successful completion of the build and automated unit test, a new release is pushed to the staging environment.</p></li>
</ul>

<p>Both methods appear to be doing the same thing, so when should I choose a CI build + release over a scheduled build? The most <a href="https://stackoverflow.com/questions/417134/continuous-integration-vs-nightly-builds">common metric</a> appears to be the duration of your build and unit tests. The size of the team, the project and code complexity and the frequency of check-ins can have an impact on the time it takes for build and long running unit tests to execute. In these scenarios a <code>Scheduled</code> build makes more sense.</p>

<h2>Overview</h2>

<p>I was disappointed to find out that, at the time of writing this post, VSTS release definitions does not provide an option to trigger off a successful a scheduled build. The only options available are to trigger it off of a CI build or the automated schedule on the release itself. </p>

<p>Luckily, Rene van Osnabrugge's <a href="https://roadtoalm.com/2017/03/30/trigger-release-pipeline-only-for-scheduled-builds/">excellent post</a> provides us with a workaround for this restriction. Here's an overview how it works:</p>

<ul>
<li>Setup a single build that performs all three roles (manually invoked, CI and scheduled). </li>
<li>Add a task into the build that would to figure out which method was used to invoke. </li>
<li>Apply the the reason as a build tag onto itself. </li>
<li>Update the release definition to filter the the release trigger to be filtered only the scheduled tags.</li>
</ul>

<p>Lets get started setting it up.</p>


		<p><a href="/2017/06/continuous-integration-and-continuous-delivery-of-dynamics-365-solutions-using-vsts/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2017/06/enforce-coding-standards-by-integrating-stylecop-validations/">Enforce Code Standards by Integrating StyleCop Validations</a></h2>
      <p class="post-date">11 Jun 2017

      | <a href="/category/alm" title="ALM">ALM</a>
      | <a href="/category/stylecop" title="StyleCop">StyleCop</a>
</p>

      <p>
		
		<p>StyleCop is a configurable analysis library that ensures code produced conforms to it's coding standard. While the benefits of a consistent coding standard is clear, each team has there own strong opinions how it should be enforced. </p>

<p>In my previous projects I've used the <code>StyleCop.MsBuild</code> package and have been eager to try out the code analyzer version of the tool. In this post, I will start off with a quick run down of my attempt at integrating it into a solution.</p>

<h2>Prerequisites</h2>

<ul>
<li>Visual Studio Professional 2015 or higher. Its not really necessary, but makes for an easier setup and nicer integration with the Roslyn base analyzer. </li>
<li>If integrating with an SCM or Automated build -  Visual Studio Team Services (VSTS) using git. The steps are not limited to VSTS, but its just my personal preference.</li>
</ul>

<h2>Installation</h2>

<p>Installation itself is pretty simple - just install the <code>StyleCop.Analyzers</code> nuget package by running the following command in the package manager console witihin Visual Studio:</p>

<pre><code>Install-Package StyleCop.Analyzers
</code></pre>

<p>That's it. That all we need to do to get started.</p>

<h2>Warning Vs. Error</h2>

<p>By default StyleCop treats suggestions as warnings, but I prefer to go strict mode and treat all style cop validations as errors. This means that build actually fails if the code does not adhere to the style validations. My justification is that its always cheaper to fix these issues early in the development cycle as well as minimizing <a href="https://blog.codinghorror.com/the-broken-window-theory/">"broken windows syndrome"</a>.</p>

<p>When using the older <code>StyleCop.MSBuild</code> package, I could just set the <code>StyleCopTreatErrorsAsWarnings</code> environmental variable in the development machine or the team build and it will ensure that the the scope is limited to the StyleCop errors only. Unfortunately, with the Analyzers project it does not seem to be that simple. There exists an <code>TreatWarningsAsErrors</code> environmental variable, but this is global and treats any warnings as errors - not what I want.</p>


		<p><a href="/2017/06/enforce-coding-standards-by-integrating-stylecop-validations/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2017/06/resolving-race-condition-within-dynamics-365-process/">Resolving a Race Condition Within a Dynamics 365 Process</a></h2>
      <p class="post-date">09 Jun 2017

      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/dynamics-crm-online" title="Dynamics CRM Online">Dynamics CRM Online</a>
</p>

      <p>
		
		<p>I was attempting to diagnose and issue for a client the other day. It revolves around a single workflow that is being executed on both the create and update event of a field. And within this workflow, a custom activity executed if the field matches a certain condition. The problem was that the custom activity was being executed twice when it was only expected to run once.</p>

<p><img src="/images/posts/AsyncWorkflow/10_singleworkflow.png" alt="Single Workflow" /> </p>

<p><img src="/images/posts/AsyncWorkflow/20_singleworkflow_trigger.png" alt="Workflow Triggger" /></p>

<p>If we take the above example, it can be replicated easily:</p>

<ol>
<li>Create a new record where <code>Delivery Status</code> is <code>Current</code>.</li>
<li>Immediately update the record to <code>Pending</code>.</li>
</ol>

<p>Navigate to the background processes and ensure that the workflow was executed twice, once on the create and then again on the update. If you performed the update soon enough, you notice that both instances satisfied the citieria and the custom activity invoked.</p>

<p>This behaviour is by design - when an async workflow is triggered it neither guarantees the immediate execution of the process nor the state of the record at the time it was queued. This means that the workflow would work against the latest version of the record at the time of execution.</p>


		<p><a href="/2017/06/resolving-race-condition-within-dynamics-365-process/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2017/05/gated-checkins-in-vsts-using-tfsvc-and-git/">Gated Check-ins in Visual Studio Team Services using TFSVC and Git</a></h2>
      <p class="post-date">15 May 2017

      | <a href="/category/visual-studio-team-services" title="Visual Studio Team Services">Visual Studio Team Services</a>
      | <a href="/category/tfsvc" title="TFSVC">TFSVC</a>
      | <a href="/category/alm" title="ALM">ALM</a>
      | <a href="/category/git" title="Git">Git</a>
</p>

      <p>
		
		<p>A continuous integration build ensures that the code within a source control repository can be compiled successfully after a commit. <a href="https://www.thoughtworks.com/continuous-integration">It is defined as</a>:</p>

<blockquote>
  <p>Continuous Integration (CI) is a development practice that requires developers to integrate code into a shared repository several times a day. Each check-in is then verified by an automated build, allowing teams to detect problems early. </p>
</blockquote>

<p>Where as CI builds occur after a commit has been merged into the repository, a gated check-in is a "pessimistic" process that would treat a commit as completed <strong>only</strong> if the result of it being merged with the repository is a successful build.</p>

<p>In this post I will try my hand in setting up a gated check-in using Visual Studio Team Services (VSTS). I will start off with TFSVC as the underlying version control system and then replicate the same functionality using Git.</p>

<h2>Configuring a Gated Check-In Using TFSVC</h2>

<p><em>Prerequisite: A repository already exists in the remote server with project code checked-in. I will be using one of my demo CRM projects.</em></p>

<ol>
<li><p>Define the steps for the build that would act as the verification build.</p>

<p><img src="/images/posts/TfsvcGatedCheckIns/10_CIBuild.png" alt="Verification Build" /></p></li>
<li><p>Navigate to the <code>Triggers</code> tab within the build definition and enabling the <code>Gated Check-In</code> trigger.</p>

<p><img src="/images/posts/TfsvcGatedCheckIns/20_GatedCheckIn.png" alt="Gated Check-In" /></p></li>
</ol>


		<p><a href="/2017/05/gated-checkins-in-vsts-using-tfsvc-and-git/">Read more...</a></p>
	  </p>
    </div>
    <div class="post other link">
      <h2><span class="mega-octicon octicon-file-text" style="min-width: 32px;"></span><a href="/2017/05/reassignment-of-record-causes-attached-notes-to-update-its-modifiedby-user-field-in-dynamics-crm/">Reassignment of Record Causes Attached Notes to Update its ModifiedBy User Field in Dynamics CRM</a></h2>
      <p class="post-date">04 May 2017

      | <a href="/category/dynamics-crm" title="Dynamics CRM">Dynamics CRM</a>
      | <a href="/category/dynamics-crm-online" title="Dynamics CRM Online">Dynamics CRM Online</a>
</p>

      <p>
		
		<p>My colleagues and I ran into a interesting problem the other day; we noticed that on some records all the notes attached to it were being updated seemingly randomly being updated. At first glance I was confused as to why this was happening, but we eventually found the steps to reproduce it: </p>

<ol>
<li>Create a record <code>Record 1</code> in an entity. This can either be a custom entity or out-of-the-box entity with notes and attachments enabled. </li>
<li>If the notes control has not been added onto the form, do that now.</li>
<li>Update it such that it has several notes created by different users.</li>
<li>Next make sure that <code>Record 1</code> is owned by <code>User A</code>.</li>
<li>Login as <code>User B</code> and reassign the <code>Record 1</code> to <code>User C</code>.</li>
</ol>

<p>Now, if we observe the notes control it shows <code>User B</code>'s name along side the date and time stamp. </p>

<p>I was initially thrown off as to why the above actions changed the <code>Created By</code> of the notes, but what I failed to realize was that the annotation control shows the <code>Modified By</code> user and not the <code>Created By</code>.</p>


		<p><a href="/2017/05/reassignment-of-record-causes-attached-notes-to-update-its-modifiedby-user-field-in-dynamics-crm/">Read more...</a></p>
	  </p>
    </div>
</div>

  <div id="post-pagination" class="pagination">



      <!--<a href="/">Previous Page</a>-->

    <p class="previous">
      <a href="/page2">Next Page</a>
    </p>

  </div>

  </div>

  <!-- /.main -->

  <script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(['_setAccount', 'UA-57983893-1']);
_gaq.push(['_trackPageview']);
        
(function () {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
})();
</script>
</body>
</html>
